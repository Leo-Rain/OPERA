clc
clear

matPOINTS(:,:,1) = [0 0 0];
matPOINTS(:,:,2) = [0 2 0];
matPOINTS(:,:,3) = [1 0 0];

matCOEFF = [0 0 0 1 0 0];

fpg = [10 20 30];

% [TR, matADJE, matELST, matVLST, matDVE, valNELE, matEATT, matEIDX, ...
%     matELOC, matPLEX, matDVECT, matALIGN, matVATT, matVNORM, matCENTER, matROTANG] = fcnTRIANG(matPOINTS);

xi_1 = matPOINTS(1,1,1);
xi_2 = matPOINTS(1,1,2);
xi_3 = matPOINTS(1,1,3);
xi_12 = xi_1;

eta_1 = matPOINTS(1,2,1);
eta_2 = matPOINTS(1,2,2);
eta_3 = matPOINTS(1,2,3);

xi_p = fpg(1);
eta_p = fpg(2);
zeta_p = fpg(3);

A1 = matCOEFF(1);
A2 = matCOEFF(2);
B1 = matCOEFF(3);
B2 = matCOEFF(4);
C2 = matCOEFF(5);
C3 = matCOEFF(6);

tic
w_xi =  sign(xi_3 - xi_p)*((B1*eta_2*zeta_p)/(xi_3 - xi_p) + (B1*eta_2*xi_p*zeta_p)/(2*(xi_3 - xi_p)^2)) ...
        - sign(xi_3 - xi_p)*((B1*eta_1*zeta_p)/(xi_3 - xi_p) + (B1*eta_1*xi_p*zeta_p)/(2*(xi_3 - xi_p)^2)) ...
        + sign(xi_12 - xi_p)*((B1*eta_1*zeta_p)/(xi_12 - xi_p) + (B1*eta_1*xi_p*zeta_p)/(2*(xi_12 - xi_p)^2)) ...
        - sign(xi_12 - xi_p)*((B1*eta_2*zeta_p)/(xi_12 - xi_p) + (B1*eta_2*xi_p*zeta_p)/(2*(xi_12 - xi_p)^2)) ...
        - (sign(xi_3 - xi_p)*(C2*eta_1^2*xi_3*zeta_p - (C2*eta_1^2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3)) ...
        + (sign(xi_3 - xi_p)*(C2*eta_2^2*xi_3*zeta_p - (C2*eta_2^2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_2 - xi_3)) ...
        + (sign(xi_12 - xi_p)*(C2*eta_1^2*xi_12*zeta_p - (C2*eta_1^2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3)) ...
        - (sign(xi_12 - xi_p)*(C2*eta_2^2*xi_12*zeta_p - (C2*eta_2^2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_2 - xi_3)) ...
        + (sign(xi_3 - xi_p)*(C2*eta_1*eta_3*xi_3*zeta_p - (C2*eta_1*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3)) ...
        - (sign(xi_3 - xi_p)*(C2*eta_2*eta_3*xi_3*zeta_p - (C2*eta_2*eta_3*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_2 - xi_3)) ...
        - (sign(xi_12 - xi_p)*(C2*eta_1*eta_3*xi_12*zeta_p - (C2*eta_1*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3)) ...
        + (sign(xi_12 - xi_p)*(C2*eta_2*eta_3*xi_12*zeta_p - (C2*eta_2*eta_3*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_2 - xi_3)) ...
        + (sign(xi_3 - xi_p)*(B1*eta_1*xi_1*xi_3*zeta_p - (B1*eta_1*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3)) ...
        - (sign(xi_3 - xi_p)*(B1*eta_3*xi_1*xi_3*zeta_p - (B1*eta_3*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3)) ...
        - (sign(xi_3 - xi_p)*(B1*eta_2*xi_2*xi_3*zeta_p - (B1*eta_2*xi_2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_2 - xi_3)) ...
        + (sign(xi_3 - xi_p)*(B1*eta_3*xi_2*xi_3*zeta_p - (B1*eta_3*xi_2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_2 - xi_3)) ...
        - (sign(xi_12 - xi_p)*(B1*eta_1*xi_1*xi_12*zeta_p - (B1*eta_1*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3)) ...
        + (sign(xi_12 - xi_p)*(B1*eta_3*xi_1*xi_12*zeta_p - (B1*eta_3*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3)) ...
        + (sign(xi_12 - xi_p)*(B1*eta_2*xi_2*xi_12*zeta_p - (B1*eta_2*xi_2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_2 - xi_3)) ...
        - (sign(xi_12 - xi_p)*(B1*eta_3*xi_2*xi_12*zeta_p - (B1*eta_3*xi_2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_2 - xi_3)) ...
        - (sign(xi_3 - xi_p)*(B2*eta_1*xi_3*zeta_p - (B2*eta_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3)) ...
        + (sign(xi_3 - xi_p)*(B2*eta_3*xi_3*zeta_p - (B2*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3)) ...
        + (sign(xi_3 - xi_p)*(B2*eta_2*xi_3*zeta_p - (B2*eta_2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_2 - xi_3)) ...
        - (sign(xi_3 - xi_p)*(B2*eta_3*xi_3*zeta_p - (B2*eta_3*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_2 - xi_3)) ...
        + (sign(xi_12 - xi_p)*(B2*eta_1*xi_12*zeta_p - (B2*eta_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3)) ...
        - (sign(xi_12 - xi_p)*(B2*eta_3*xi_12*zeta_p - (B2*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3)) ...
        - (sign(xi_12 - xi_p)*(B2*eta_2*xi_12*zeta_p - (B2*eta_2*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_2 - xi_3)) ...
        + (sign(xi_12 - xi_p)*(B2*eta_3*xi_12*zeta_p - (B2*eta_3*xi_p*zeta_p)/2))/(xi_2*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_2*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_2 - xi_3)) ...
        + (xi_1*sign(xi_3 - xi_p)*(C2*eta_1^2*xi_3*zeta_p - (C2*eta_1^2*xi_p*zeta_p)/2))/(xi_1^2*xi_p^2 + xi_3^2*xi_p^2 - xi_3*(2*xi_1^2*xi_p + 2*xi_3^2*xi_p - 4*xi_1*xi_3*xi_p) + xi_3^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2) - 2*xi_1*xi_3*xi_p^2) ...
        + (xi_1*sign(xi_3 - xi_p)*(C2*eta_3^2*xi_3*zeta_p - (C2*eta_3^2*xi_p*zeta_p)/2))/(xi_1^2*xi_p^2 + xi_3^2*xi_p^2 - xi_3*(2*xi_1^2*xi_p + 2*xi_3^2*xi_p - 4*xi_1*xi_3*xi_p) + xi_3^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2) - 2*xi_1*xi_3*xi_p^2) ...
        - (xi_2*sign(xi_3 - xi_p)*(C2*eta_2^2*xi_3*zeta_p - (C2*eta_2^2*xi_p*zeta_p)/2))/(xi_2^2*xi_p^2 + xi_3^2*xi_p^2 - xi_3*(2*xi_2^2*xi_p + 2*xi_3^2*xi_p - 4*xi_2*xi_3*xi_p) + xi_3^2*(xi_2^2 - 2*xi_2*xi_3 + xi_3^2) - 2*xi_2*xi_3*xi_p^2) ...
        - (xi_2*sign(xi_3 - xi_p)*(C2*eta_3^2*xi_3*zeta_p - (C2*eta_3^2*xi_p*zeta_p)/2))/(xi_2^2*xi_p^2 + xi_3^2*xi_p^2 - xi_3*(2*xi_2^2*xi_p + 2*xi_3^2*xi_p - 4*xi_2*xi_3*xi_p) + xi_3^2*(xi_2^2 - 2*xi_2*xi_3 + xi_3^2) - 2*xi_2*xi_3*xi_p^2) ...
        - (xi_1*sign(xi_12 - xi_p)*(C2*eta_1^2*xi_12*zeta_p - (C2*eta_1^2*xi_p*zeta_p)/2))/(xi_1^2*xi_p^2 + xi_3^2*xi_p^2 - xi_12*(2*xi_1^2*xi_p + 2*xi_3^2*xi_p - 4*xi_1*xi_3*xi_p) + xi_12^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2) - 2*xi_1*xi_3*xi_p^2) ...
        - (xi_1*sign(xi_12 - xi_p)*(C2*eta_3^2*xi_12*zeta_p - (C2*eta_3^2*xi_p*zeta_p)/2))/(xi_1^2*xi_p^2 + xi_3^2*xi_p^2 - xi_12*(2*xi_1^2*xi_p + 2*xi_3^2*xi_p - 4*xi_1*xi_3*xi_p) + xi_12^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2) - 2*xi_1*xi_3*xi_p^2) ...
        + (xi_2*sign(xi_12 - xi_p)*(C2*eta_2^2*xi_12*zeta_p - (C2*eta_2^2*xi_p*zeta_p)/2))/(xi_2^2*xi_p^2 + xi_3^2*xi_p^2 - xi_12*(2*xi_2^2*xi_p + 2*xi_3^2*xi_p - 4*xi_2*xi_3*xi_p) + xi_12^2*(xi_2^2 - 2*xi_2*xi_3 + xi_3^2) - 2*xi_2*xi_3*xi_p^2) ...
        + (xi_2*sign(xi_12 - xi_p)*(C2*eta_3^2*xi_12*zeta_p - (C2*eta_3^2*xi_p*zeta_p)/2))/(xi_2^2*xi_p^2 + xi_3^2*xi_p^2 - xi_12*(2*xi_2^2*xi_p + 2*xi_3^2*xi_p - 4*xi_2*xi_3*xi_p) + xi_12^2*(xi_2^2 - 2*xi_2*xi_3 + xi_3^2) - 2*xi_2*xi_3*xi_p^2) ...
        - (xi_1*sign(xi_3 - xi_p)*(2*C2*eta_1*eta_3*xi_3*zeta_p - C2*eta_1*eta_3*xi_p*zeta_p))/(xi_1^2*xi_p^2 + xi_3^2*xi_p^2 - xi_3*(2*xi_1^2*xi_p + 2*xi_3^2*xi_p - 4*xi_1*xi_3*xi_p) + xi_3^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2) - 2*xi_1*xi_3*xi_p^2) ...
        + (xi_2*sign(xi_3 - xi_p)*(2*C2*eta_2*eta_3*xi_3*zeta_p - C2*eta_2*eta_3*xi_p*zeta_p))/(xi_2^2*xi_p^2 + xi_3^2*xi_p^2 - xi_3*(2*xi_2^2*xi_p + 2*xi_3^2*xi_p - 4*xi_2*xi_3*xi_p) + xi_3^2*(xi_2^2 - 2*xi_2*xi_3 + xi_3^2) - 2*xi_2*xi_3*xi_p^2) ...
        + (xi_1*sign(xi_12 - xi_p)*(2*C2*eta_1*eta_3*xi_12*zeta_p - C2*eta_1*eta_3*xi_p*zeta_p))/(xi_1^2*xi_p^2 + xi_3^2*xi_p^2 - xi_12*(2*xi_1^2*xi_p + 2*xi_3^2*xi_p - 4*xi_1*xi_3*xi_p) + xi_12^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2) - 2*xi_1*xi_3*xi_p^2) ...
        - (xi_2*sign(xi_12 - xi_p)*(2*C2*eta_2*eta_3*xi_12*zeta_p - C2*eta_2*eta_3*xi_p*zeta_p))/(xi_2^2*xi_p^2 + xi_3^2*xi_p^2 - xi_12*(2*xi_2^2*xi_p + 2*xi_3^2*xi_p - 4*xi_2*xi_3*xi_p) + xi_12^2*(xi_2^2 - 2*xi_2*xi_3 + xi_3^2) - 2*xi_2*xi_3*xi_p^2) ...
        - (C2*eta_1^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_3 - xi_p)^2) ...
        + (C2*eta_2^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_3 - xi_p)^2) ...
        + (C2*eta_1^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_12 - xi_p)^2) ...
        - (C2*eta_2^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_12 - xi_p)^2) ...
        - (B2*eta_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2) ...
        + (B2*eta_2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2) ...
        + (B2*eta_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2) ...
        - (B2*eta_2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2) ...
        + (C2*eta_1^2*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(4*(xi_1 - xi_3)^2*(xi_3 - xi_p)^2) ...
        - (C2*eta_2^2*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(4*(xi_2 - xi_3)^2*(xi_3 - xi_p)^2) ...
        + (C2*eta_3^2*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(4*(xi_1 - xi_3)^2*(xi_3 - xi_p)^2) ...
        - (C2*eta_3^2*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(4*(xi_2 - xi_3)^2*(xi_3 - xi_p)^2) ...
        - (C2*eta_1^2*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(4*(xi_1 - xi_3)^2*(xi_12 - xi_p)^2) ...
        + (C2*eta_2^2*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(4*(xi_2 - xi_3)^2*(xi_12 - xi_p)^2) ...
        - (C2*eta_3^2*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(4*(xi_1 - xi_3)^2*(xi_12 - xi_p)^2) ...
        + (C2*eta_3^2*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(4*(xi_2 - xi_3)^2*(xi_12 - xi_p)^2) ...
        + (B2*eta_1*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2) ...
        - (B2*eta_3*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2) ...
        - (B2*eta_2*xi_2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2) ...
        + (B2*eta_3*xi_2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2) ...
        - (B2*eta_1*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2) ...
        + (B2*eta_3*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2) ...
        + (B2*eta_2*xi_2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2) ...
        - (B2*eta_3*xi_2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2) ...
        + (C2*eta_1^2*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2) ...
        - (C2*eta_2^2*xi_2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2) ...
        - (C2*eta_1^2*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2) ...
        + (C2*eta_2^2*xi_2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2) ...
        + (B1*eta_1*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2) ...
        - (B1*eta_2*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2) ...
        - (B1*eta_3*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2) ...
        + (B1*eta_3*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2) ...
        - (B1*eta_1*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2) ...
        + (B1*eta_2*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2) ...
        + (B1*eta_3*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2) ...
        - (B1*eta_3*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2) ...
        - (C2*eta_1^2*xi_1^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_1 - xi_3)^2*(xi_3 - xi_p)^2) ...
        - (C2*eta_3^2*xi_1^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_1 - xi_3)^2*(xi_3 - xi_p)^2) ...
        + (C2*eta_2^2*xi_2^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_2 - xi_3)^2*(xi_3 - xi_p)^2) ...
        + (C2*eta_3^2*xi_2^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_2 - xi_3)^2*(xi_3 - xi_p)^2) ...
        + (C2*eta_1^2*xi_1^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_1 - xi_3)^2*(xi_12 - xi_p)^2) ...
        + (C2*eta_3^2*xi_1^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_1 - xi_3)^2*(xi_12 - xi_p)^2) ...
        - (C2*eta_2^2*xi_2^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_2 - xi_3)^2*(xi_12 - xi_p)^2) ...
        - (C2*eta_3^2*xi_2^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_2 - xi_3)^2*(xi_12 - xi_p)^2) ...
        + (C2*eta_1*eta_3*xi_1^2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)^2*(xi_3 - xi_p)^2) ...
        - (C2*eta_2*eta_3*xi_2^2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_2 - xi_3)^2*(xi_3 - xi_p)^2) ...
        - (C2*eta_1*eta_3*xi_1^2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)^2*(xi_12 - xi_p)^2) ...
        + (C2*eta_2*eta_3*xi_2^2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_2 - xi_3)^2*(xi_12 - xi_p)^2) ...
        - (C2*eta_1*eta_3*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_1 - xi_3)^2*(xi_3 - xi_p)^2) ...
        + (C2*eta_2*eta_3*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_2 - xi_3)^2*(xi_3 - xi_p)^2) ...
        + (C2*eta_1*eta_3*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_1 - xi_3)^2*(xi_12 - xi_p)^2) ...
        - (C2*eta_2*eta_3*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_2 - xi_3)^2*(xi_12 - xi_p)^2) ...
        - (C2*eta_1*eta_3*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2) ...
        + (C2*eta_2*eta_3*xi_2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2) ...
        + (C2*eta_1*eta_3*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2) ...
        - (C2*eta_2*eta_3*xi_2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2);

    
    
toc

% w_ind = [w_xi; w_eta; w_zeta]
