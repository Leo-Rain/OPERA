clc
clear

matPOINTS(:,:,1) = [0 0 0];
matPOINTS(:,:,2) = [0 2 0];
matPOINTS(:,:,3) = [1 0.5 0];

matCOEFF = [0 0 0 0 1 0];

hFig203 = figure(203);
clf(203);
patch(reshape(matPOINTS(:,1,:),[],1,1),reshape(matPOINTS(:,2,:),[],1,1),reshape(matPOINTS(:,3,:),[],1,1),'FaceColor','red','FaceAlpha',0.3,'LineWidth',2)
axis equal
axis tight
grid minor
box on
xlabel('\xi-Direction','FontSize',15);
ylabel('\eta-Direction','FontSize',15);
zlabel('\zeta-Direction','FontSize',15);

% [TR, matADJE, matELST, matVLST, matDVE, valNELE, matEATT, matEIDX, ...
%     matELOC, matPLEX, matDVECT, matALIGN, matVATT, matVNORM, matCENTER, matROTANG] = fcnTRIANG(matPOINTS);

fpg = [2 5 1];

granularity = 0.1;
y = -0.2:granularity:2;
z = .4:granularity:0.4;
x = -.4:granularity:1.3;

[X,Y,Z] = meshgrid(x,y,z);
fpg = unique([reshape(X,[],1) reshape(Y,[],1) reshape(Z,[],1)],'rows');

tic
for i = 1:size(fpg,1)
  q_ind(i,:) = induc(matPOINTS, fpg(i,:), matCOEFF);
end
toc

hold on
quiver3(fpg(:,1), fpg(:,2), fpg(:,3), q_ind(:,1).*0, q_ind(:,2).*0, q_ind(:,3))
hold off

function [w_ind] = induc(matPOINTS, fpg, matCOEFF)
xi_1 = matPOINTS(1,1,1);
xi_2 = matPOINTS(1,1,2);
xi_3 = matPOINTS(1,1,3);
xi_12 = xi_1;

eta_1 = matPOINTS(1,2,1);
eta_2 = matPOINTS(1,2,2);
eta_3 = matPOINTS(1,2,3);

xi_p = fpg(1);
eta_p = fpg(2);
zeta_p = fpg(3);

A1 = matCOEFF(1);
A2 = matCOEFF(2);
B1 = matCOEFF(3);
B2 = matCOEFF(4);
C2 = matCOEFF(5);
C3 = matCOEFF(6);

w_xi =  ...
+ (-sign(xi_3 - xi_p)*((B1*eta_1*zeta_p)/(xi_3 - xi_p) + (B1*eta_1*xi_p*zeta_p)/(2*(xi_3 - xi_p)^2))) ... 
+ (sign(xi_3 - xi_p)*((B1*eta_2*zeta_p)/(xi_3 - xi_p) + (B1*eta_2*xi_p*zeta_p)/(2*(xi_3 - xi_p)^2))) ... 
+ (sign(xi_12 - xi_p)*((B1*eta_1*zeta_p)/(xi_12 - xi_p) + (B1*eta_1*xi_p*zeta_p)/(2*(xi_12 - xi_p)^2))) ... 
+ (-sign(xi_12 - xi_p)*((B1*eta_2*zeta_p)/(xi_12 - xi_p) + (B1*eta_2*xi_p*zeta_p)/(2*(xi_12 - xi_p)^2))) ... 
+ (-(sign(xi_3 - xi_p)*(C2*eta_1^2*xi_3*zeta_p - (C2*eta_1^2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_3 - xi_p)*(C2*eta_2^2*xi_3*zeta_p - (C2*eta_2^2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_12 - xi_p)*(C2*eta_1^2*xi_12*zeta_p - (C2*eta_1^2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ (-(sign(xi_12 - xi_p)*(C2*eta_2^2*xi_12*zeta_p - (C2*eta_2^2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_3 - xi_p)*(C2*eta_1*eta_3*xi_3*zeta_p - (C2*eta_1*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ (-(sign(xi_3 - xi_p)*(C2*eta_2*eta_3*xi_3*zeta_p - (C2*eta_2*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ (-(sign(xi_12 - xi_p)*(C2*eta_1*eta_3*xi_12*zeta_p - (C2*eta_1*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_12 - xi_p)*(C2*eta_2*eta_3*xi_12*zeta_p - (C2*eta_2*eta_3*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_3 - xi_p)*(B1*eta_1*xi_1*xi_3*zeta_p - (B1*eta_1*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ (-(sign(xi_3 - xi_p)*(B1*eta_2*xi_1*xi_3*zeta_p - (B1*eta_2*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ (-(sign(xi_12 - xi_p)*(B1*eta_1*xi_1*xi_12*zeta_p - (B1*eta_1*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_12 - xi_p)*(B1*eta_2*xi_1*xi_12*zeta_p - (B1*eta_2*xi_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ (-(sign(xi_3 - xi_p)*(B2*eta_1*xi_3*zeta_p - (B2*eta_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_3 - xi_p)*(B2*eta_2*xi_3*zeta_p - (B2*eta_2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_3*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_3^2*(xi_1 - xi_3))) ... 
+ ((sign(xi_12 - xi_p)*(B2*eta_1*xi_12*zeta_p - (B2*eta_1*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ (-(sign(xi_12 - xi_p)*(B2*eta_2*xi_12*zeta_p - (B2*eta_2*xi_p*zeta_p)/2))/(xi_1*xi_p^2 - xi_3*xi_p^2 - xi_12*(2*xi_1*xi_p - 2*xi_3*xi_p) + xi_12^2*(xi_1 - xi_3))) ... 
+ (-(C2*eta_1^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_3 - xi_p)^2)) ... 
+ ((C2*eta_2^2*zeta_p*sign(xi_3 - xi_p))/(4*(xi_3 - xi_p)^2)) ... 
+ ((C2*eta_1^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_12 - xi_p)^2)) ... 
+ (-(C2*eta_2^2*zeta_p*sign(xi_12 - xi_p))/(4*(xi_12 - xi_p)^2)) ... 
+ (-(B2*eta_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2)) ... 
+ ((B2*eta_2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2)) ... 
+ ((B2*eta_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2)) ... 
+ (-(B2*eta_2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2)) ... 
+ (-(C2*eta_1^2*zeta_p*sign(xi_3 - xi_p)*(xi_p^2/(2*(xi_3 - xi_p)^2) - log(xi_3 - xi_p) + (2*xi_p)/(xi_3 - xi_p)))/(2*(xi_1 - xi_3)^2)) ... 
+ ((C2*eta_2^2*zeta_p*sign(xi_3 - xi_p)*(xi_p^2/(2*(xi_3 - xi_p)^2) - log(xi_3 - xi_p) + (2*xi_p)/(xi_3 - xi_p)))/(2*(xi_1 - xi_3)^2)) ... 
+ ((C2*eta_1^2*zeta_p*sign(xi_12 - xi_p)*(xi_p^2/(2*(xi_12 - xi_p)^2) - log(xi_12 - xi_p) + (2*xi_p)/(xi_12 - xi_p)))/(2*(xi_1 - xi_3)^2)) ... 
+ (-(C2*eta_2^2*zeta_p*sign(xi_12 - xi_p)*(xi_p^2/(2*(xi_12 - xi_p)^2) - log(xi_12 - xi_p) + (2*xi_p)/(xi_12 - xi_p)))/(2*(xi_1 - xi_3)^2)) ... 
+ ((C2*eta_1*eta_3*zeta_p*sign(xi_3 - xi_p)*(xi_p^2/(2*(xi_3 - xi_p)^2) - log(xi_3 - xi_p) + (2*xi_p)/(xi_3 - xi_p)))/(xi_1 - xi_3)^2) ... 
+ (-(C2*eta_2*eta_3*zeta_p*sign(xi_3 - xi_p)*(xi_p^2/(2*(xi_3 - xi_p)^2) - log(xi_3 - xi_p) + (2*xi_p)/(xi_3 - xi_p)))/(xi_1 - xi_3)^2) ... 
+ (-(C2*eta_1*eta_3*zeta_p*sign(xi_12 - xi_p)*(xi_p^2/(2*(xi_12 - xi_p)^2) - log(xi_12 - xi_p) + (2*xi_p)/(xi_12 - xi_p)))/(xi_1 - xi_3)^2) ... 
+ ((C2*eta_2*eta_3*zeta_p*sign(xi_12 - xi_p)*(xi_p^2/(2*(xi_12 - xi_p)^2) - log(xi_12 - xi_p) + (2*xi_p)/(xi_12 - xi_p)))/(xi_1 - xi_3)^2) ... 
+ ((B2*eta_1*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ (-(B2*eta_2*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ (-(B2*eta_1*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ ((B2*eta_2*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ (-(C2*eta_1^2*xi_1^2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2*(2*xi_1^2 - 4*xi_1*xi_3 + 2*xi_3^2))) ... 
+ ((C2*eta_2^2*xi_1^2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2*(2*xi_1^2 - 4*xi_1*xi_3 + 2*xi_3^2))) ... 
+ ((C2*eta_1^2*xi_1^2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2*(2*xi_1^2 - 4*xi_1*xi_3 + 2*xi_3^2))) ... 
+ (-(C2*eta_2^2*xi_1^2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2*(2*xi_1^2 - 4*xi_1*xi_3 + 2*xi_3^2))) ... 
+ ((C2*eta_1^2*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ (-(C2*eta_2^2*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ (-(C2*eta_1^2*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ ((C2*eta_2^2*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ ((B1*eta_1*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ (-(B1*eta_2*zeta_p*sign(xi_3 - xi_p)*(2*xi_3^2*log(xi_3 - xi_p) - 4*xi_3*xi_p + 2*xi_p^2*log(xi_3 - xi_p) + 3*xi_p^2 - 4*xi_3*xi_p*log(xi_3 - xi_p)))/(2*(xi_2 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ (-(B1*eta_1*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ ((B1*eta_2*zeta_p*sign(xi_12 - xi_p)*(2*xi_12^2*log(xi_12 - xi_p) - 4*xi_12*xi_p + 2*xi_p^2*log(xi_12 - xi_p) + 3*xi_p^2 - 4*xi_12*xi_p*log(xi_12 - xi_p)))/(2*(xi_2 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ ((C2*eta_1^2*xi_1*zeta_p*sign(xi_3 - xi_p)*(1/(xi_3 - xi_p) + xi_p/(2*(xi_3 - xi_p)^2)))/(xi_1 - xi_3)^2) ... 
+ (-(C2*eta_2^2*xi_1*zeta_p*sign(xi_3 - xi_p)*(1/(xi_3 - xi_p) + xi_p/(2*(xi_3 - xi_p)^2)))/(xi_1 - xi_3)^2) ... 
+ (-(C2*eta_1^2*xi_1*zeta_p*sign(xi_12 - xi_p)*(1/(xi_12 - xi_p) + xi_p/(2*(xi_12 - xi_p)^2)))/(xi_1 - xi_3)^2) ... 
+ ((C2*eta_2^2*xi_1*zeta_p*sign(xi_12 - xi_p)*(1/(xi_12 - xi_p) + xi_p/(2*(xi_12 - xi_p)^2)))/(xi_1 - xi_3)^2) ... 
+ (-(C2*eta_1*eta_3*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ ((C2*eta_2*eta_3*xi_1*zeta_p*sign(xi_3 - xi_p))/(2*(xi_1 - xi_3)*(xi_3 - xi_p)^2)) ... 
+ ((C2*eta_1*eta_3*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ (-(C2*eta_2*eta_3*xi_1*zeta_p*sign(xi_12 - xi_p))/(2*(xi_1 - xi_3)*(xi_12 - xi_p)^2)) ... 
+ ((C2*eta_1*eta_3*xi_1^2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2))) ... 
+ (-(C2*eta_2*eta_3*xi_1^2*zeta_p*sign(xi_3 - xi_p))/(2*(xi_3 - xi_p)^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2))) ... 
+ (-(C2*eta_1*eta_3*xi_1^2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2))) ... 
+ ((C2*eta_2*eta_3*xi_1^2*zeta_p*sign(xi_12 - xi_p))/(2*(xi_12 - xi_p)^2*(xi_1^2 - 2*xi_1*xi_3 + xi_3^2))) ... 
+ (-(2*C2*eta_1*eta_3*xi_1*zeta_p*sign(xi_3 - xi_p)*(1/(xi_3 - xi_p) + xi_p/(2*(xi_3 - xi_p)^2)))/(xi_1 - xi_3)^2) ... 
+ ((2*C2*eta_2*eta_3*xi_1*zeta_p*sign(xi_3 - xi_p)*(1/(xi_3 - xi_p) + xi_p/(2*(xi_3 - xi_p)^2)))/(xi_1 - xi_3)^2) ... 
+ ((2*C2*eta_1*eta_3*xi_1*zeta_p*sign(xi_12 - xi_p)*(1/(xi_12 - xi_p) + xi_p/(2*(xi_12 - xi_p)^2)))/(xi_1 - xi_3)^2) ... 
+ (-(2*C2*eta_2*eta_3*xi_1*zeta_p*sign(xi_12 - xi_p)*(1/(xi_12 - xi_p) + xi_p/(2*(xi_12 - xi_p)^2)))/(xi_1 - xi_3)^2); 

w_eta = ...
+ (sign(xi_12 - xi_p)*((C2*zeta_p*log(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_12*(eta_1 - eta_3))*sign(eta_1*xi_3 - eta_3*xi_1 - eta_1*xi_12 + eta_3*xi_12 + eta_p*xi_1 - eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_1^2 - 2*eta_1*eta_3 + eta_3^2)) - (C2*zeta_p*sign(eta_1*xi_3 - eta_3*xi_1 - eta_1*xi_12 + eta_3*xi_12 + eta_p*xi_1 - eta_p*xi_3)*(xi_1 - xi_3)^2*(eta_1*xi_3 - eta_3*xi_1 + eta_p*xi_1 - eta_p*xi_3))/(2*(eta_1 - eta_3)^2*(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_12*(eta_1 - eta_3))))) ... 
+ (-sign(xi_12 - xi_p)*((C2*zeta_p*log(eta_3*xi_2 - eta_2*xi_3 - eta_p*xi_2 + eta_p*xi_3 + xi_12*(eta_2 - eta_3))*sign(eta_2*xi_3 - eta_3*xi_2 - eta_2*xi_12 + eta_3*xi_12 + eta_p*xi_2 - eta_p*xi_3)*(xi_2 - xi_3)^2)/(2*(eta_2^2 - 2*eta_2*eta_3 + eta_3^2)) - (C2*zeta_p*sign(eta_2*xi_3 - eta_3*xi_2 - eta_2*xi_12 + eta_3*xi_12 + eta_p*xi_2 - eta_p*xi_3)*(xi_2 - xi_3)^2*(eta_2*xi_3 - eta_3*xi_2 + eta_p*xi_2 - eta_p*xi_3))/(2*(eta_2 - eta_3)^2*(eta_3*xi_2 - eta_2*xi_3 - eta_p*xi_2 + eta_p*xi_3 + xi_12*(eta_2 - eta_3))))) ... 
+ (sign(xi_3 - xi_p)*((C2*zeta_p*log(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_3*(eta_1 - eta_3))*sign(eta_3*xi_1 - eta_3*xi_3 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_1^2 - 2*eta_1*eta_3 + eta_3^2)) - (C2*zeta_p*sign(eta_3*xi_1 - eta_3*xi_3 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2*(eta_1*xi_3 - eta_3*xi_1 + eta_p*xi_1 - eta_p*xi_3))/(2*(eta_1 - eta_3)^2*(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_3*(eta_1 - eta_3))))) ... 
+ (-sign(xi_3 - xi_p)*((C2*zeta_p*log(eta_3*xi_2 - eta_2*xi_3 - eta_p*xi_2 + eta_p*xi_3 + xi_3*(eta_2 - eta_3))*sign(eta_3*xi_2 - eta_3*xi_3 - eta_p*xi_2 + eta_p*xi_3)*(xi_2 - xi_3)^2)/(2*(eta_2^2 - 2*eta_2*eta_3 + eta_3^2)) - (C2*zeta_p*sign(eta_3*xi_2 - eta_3*xi_3 - eta_p*xi_2 + eta_p*xi_3)*(xi_2 - xi_3)^2*(eta_2*xi_3 - eta_3*xi_2 + eta_p*xi_2 - eta_p*xi_3))/(2*(eta_2 - eta_3)^2*(eta_3*xi_2 - eta_2*xi_3 - eta_p*xi_2 + eta_p*xi_3 + xi_3*(eta_2 - eta_3))))) ... 
+ (-(A1*zeta_p*log(eta_p*xi_3 - eta_1*xi_3 + xi_12*(eta_1 - eta_3) + xi_2*(eta_3 - eta_p))*sign(xi_12 - xi_p)*sign(eta_1*xi_12 - eta_1*xi_3 - eta_3*xi_12 + eta_p*xi_3 + xi_2*(eta_3 - eta_p))*(xi_2 - xi_3))/(eta_1 - eta_3)) ... 
+ (-(A2*zeta_p*sign(xi_3 - xi_p)*sign(eta_3*xi_1 - eta_3*xi_3 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_1 - eta_3)*(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_3*(eta_1 - eta_3)))) ... 
+ ((A2*zeta_p*sign(xi_3 - xi_p)*sign(eta_3*xi_1 - eta_3*xi_3 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_2 - eta_3)*(eta_3*xi_1 - eta_2*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_3*(eta_2 - eta_3)))) ... 
+ ((A1*zeta_p*log(eta_3*xi_1 - eta_2*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_12*(eta_2 - eta_3))*sign(xi_12 - xi_p)*sign(eta_3*xi_1 - eta_2*xi_3 + eta_2*xi_12 - eta_3*xi_12 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3))/(eta_2 - eta_3)) ... 
+ (-(A2*zeta_p*sign(xi_12 - xi_p)*sign(eta_1*xi_3 - eta_3*xi_1 - eta_1*xi_12 + eta_3*xi_12 + eta_p*xi_1 - eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_1 - eta_3)*(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_12*(eta_1 - eta_3)))) ... 
+ (-(A2*zeta_p*sign(xi_12 - xi_p)*sign(eta_3*xi_1 - eta_2*xi_3 + eta_2*xi_12 - eta_3*xi_12 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_2 - eta_3)*(eta_3*xi_1 - eta_2*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_12*(eta_2 - eta_3)))) ... 
+ ((A1*zeta_p*log(eta_p*xi_3 - eta_1*xi_3 + xi_3*(eta_1 - eta_3) + xi_2*(eta_3 - eta_p))*sign(xi_3 - xi_p)*sign(eta_p*xi_3 - eta_3*xi_3 + xi_2*(eta_3 - eta_p))*(xi_2 - xi_3))/(eta_1 - eta_3)) ... 
+ (-(A1*zeta_p*log(eta_3*xi_1 - eta_2*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_3*(eta_2 - eta_3))*sign(xi_3 - xi_p)*sign(eta_3*xi_1 - eta_3*xi_3 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3))/(eta_2 - eta_3)) ... 
+ (-(A1*eta_p*zeta_p*sign(xi_3 - xi_p)*sign(eta_3*xi_1 - eta_3*xi_3 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_1 - eta_3)*(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_3*(eta_1 - eta_3)))) ... 
+ ((A1*eta_p*zeta_p*sign(xi_3 - xi_p)*sign(eta_3*xi_1 - eta_3*xi_3 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_2 - eta_3)*(eta_3*xi_1 - eta_2*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_3*(eta_2 - eta_3)))) ... 
+ (-(A1*eta_p*zeta_p*sign(xi_12 - xi_p)*sign(eta_1*xi_3 - eta_3*xi_1 - eta_1*xi_12 + eta_3*xi_12 + eta_p*xi_1 - eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_1 - eta_3)*(eta_3*xi_1 - eta_1*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_12*(eta_1 - eta_3)))) ... 
+ (-(A1*eta_p*zeta_p*sign(xi_12 - xi_p)*sign(eta_3*xi_1 - eta_2*xi_3 + eta_2*xi_12 - eta_3*xi_12 - eta_p*xi_1 + eta_p*xi_3)*(xi_1 - xi_3)^2)/(2*(eta_2 - eta_3)*(eta_3*xi_1 - eta_2*xi_3 - eta_p*xi_1 + eta_p*xi_3 + xi_12*(eta_2 - eta_3)))); 


w_zeta = ...
-((eta_1 - eta_2)*(xi_3 - xi_12)^2*(B1*xi_3^4 + 2*B2*xi_3^3 + A1*eta_1^2*xi_3^2 + 6*A1*eta_3^2*xi_1^2 + A1*eta_2^2*xi_3^2 + A1*eta_3^2*xi_3^2 + A1*eta_1^2*xi_12^2 + A1*eta_2^2*xi_12^2 + 3*A1*eta_3^2*xi_12^2 + B1*xi_1^2*xi_3^2 + 3*B1*xi_1^2*xi_12^2 + 3*B1*xi_3^2*xi_12^2 + 2*A2*eta_1*xi_3^2 + 6*A2*eta_3*xi_1^2 + 2*A2*eta_2*xi_3^2 + 2*A2*eta_3*xi_3^2 - 6*A2*eta_p*xi_1^2 - 6*A2*eta_p*xi_3^2 + C2*eta_1*xi_3^3 + C2*eta_2*xi_3^3 + 2*C2*eta_3*xi_3^3 - 2*C2*eta_p*xi_3^3 - 2*B1*xi_1*xi_3^3 - 4*B2*xi_1*xi_3^2 + 2*B2*xi_1^2*xi_3 + 4*B2*xi_1^2*xi_12 + 2*B1*xi_3^3*xi_12 + 4*B2*xi_3^2*xi_12 - 6*B2*xi_1^2*xi_p - 2*B1*xi_3^3*xi_p - 6*B2*xi_3^2*xi_p - 8*B2*xi_1*xi_3*xi_12 + 12*B2*xi_1*xi_3*xi_p + A1*eta_1*eta_2*xi_3^2 + A1*eta_1*eta_3*xi_3^2 + A1*eta_2*eta_3*xi_3^2 + A1*eta_1*eta_2*xi_12^2 - 3*A1*eta_1*eta_3*xi_12^2 - 3*A1*eta_2*eta_3*xi_12^2 - 2*A1*eta_1*eta_p*xi_3^2 - 6*A1*eta_3*eta_p*xi_1^2 - 2*A1*eta_2*eta_p*xi_3^2 - 2*A1*eta_3*eta_p*xi_3^2 - 4*A1*eta_3^2*xi_1*xi_3 - 2*A1*eta_1^2*xi_3*xi_12 - 8*A1*eta_3^2*xi_1*xi_12 - 2*A1*eta_2^2*xi_3*xi_12 + 2*A1*eta_3^2*xi_3*xi_12 - C2*eta_1*xi_1*xi_3^2 - C2*eta_2*xi_1*xi_3^2 - 6*C2*eta_3*xi_1*xi_3^2 + 4*C2*eta_3*xi_1^2*xi_3 + 3*C2*eta_1*xi_1*xi_12^2 + 3*C2*eta_2*xi_1*xi_12^2 - 3*C2*eta_1*xi_3*xi_12^2 + 2*C2*eta_1*xi_3^2*xi_12 - 6*C2*eta_3*xi_1*xi_12^2 + 8*C2*eta_3*xi_1^2*xi_12 - 3*C2*eta_2*xi_3*xi_12^2 + 2*C2*eta_2*xi_3^2*xi_12 + 6*C2*eta_3*xi_3*xi_12^2 + 4*C2*eta_3*xi_3^2*xi_12 - 2*C2*eta_1*xi_3^2*xi_p - 6*C2*eta_3*xi_1^2*xi_p + 4*C2*eta_p*xi_1*xi_3^2 - 2*C2*eta_p*xi_1^2*xi_3 - 2*C2*eta_2*xi_3^2*xi_p - 2*C2*eta_3*xi_3^2*xi_p - 4*C2*eta_p*xi_1^2*xi_12 - 4*C2*eta_p*xi_3^2*xi_12 - 6*B1*xi_1*xi_3*xi_12^2 - 4*B1*xi_1*xi_3^2*xi_12 + 2*B1*xi_1^2*xi_3*xi_12 + 4*B1*xi_1*xi_3^2*xi_p - 2*B1*xi_1^2*xi_3*xi_p - 4*B1*xi_1^2*xi_12*xi_p - 4*B1*xi_3^2*xi_12*xi_p - 2*A2*eta_1*xi_1*xi_3 - 2*A2*eta_2*xi_1*xi_3 - 8*A2*eta_3*xi_1*xi_3 + 2*A2*eta_1*xi_1*xi_12 + 2*A2*eta_2*xi_1*xi_12 - 2*A2*eta_1*xi_3*xi_12 - 4*A2*eta_3*xi_1*xi_12 - 2*A2*eta_2*xi_3*xi_12 + 4*A2*eta_3*xi_3*xi_12 + 12*A2*eta_p*xi_1*xi_3 - 4*A1*eta_1*eta_3*xi_1*xi_3 - 4*A1*eta_2*eta_3*xi_1*xi_3 + 4*A1*eta_1*eta_3*xi_1*xi_12 - 2*A1*eta_1*eta_2*xi_3*xi_12 + 4*A1*eta_2*eta_3*xi_1*xi_12 + 2*A1*eta_1*eta_3*xi_3*xi_12 + 2*A1*eta_2*eta_3*xi_3*xi_12 + 2*A1*eta_1*eta_p*xi_1*xi_3 + 2*A1*eta_2*eta_p*xi_1*xi_3 + 8*A1*eta_3*eta_p*xi_1*xi_3 - 2*A1*eta_1*eta_p*xi_1*xi_12 - 2*A1*eta_2*eta_p*xi_1*xi_12 + 2*A1*eta_1*eta_p*xi_3*xi_12 + 4*A1*eta_3*eta_p*xi_1*xi_12 + 2*A1*eta_2*eta_p*xi_3*xi_12 - 4*A1*eta_3*eta_p*xi_3*xi_12 - 2*C2*eta_1*xi_1*xi_3*xi_12 - 2*C2*eta_2*xi_1*xi_3*xi_12 - 12*C2*eta_3*xi_1*xi_3*xi_12 + 2*C2*eta_1*xi_1*xi_3*xi_p + 2*C2*eta_2*xi_1*xi_3*xi_p + 8*C2*eta_3*xi_1*xi_3*xi_p - 2*C2*eta_1*xi_1*xi_12*xi_p - 2*C2*eta_2*xi_1*xi_12*xi_p + 2*C2*eta_1*xi_3*xi_12*xi_p + 4*C2*eta_3*xi_1*xi_12*xi_p + 8*C2*eta_p*xi_1*xi_3*xi_12 + 2*C2*eta_2*xi_3*xi_12*xi_p - 4*C2*eta_3*xi_3*xi_12*xi_p + 8*B1*xi_1*xi_3*xi_12*xi_p))/(12*abs(zeta_p)^3*(xi_1 - xi_3)^3); 

w_ind = [w_xi w_eta w_zeta];

end
