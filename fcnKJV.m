function [v_out] = fcnKJV(xi_1, xi_3, eta_1, eta_3, E, D_TE, A_1, A_2, B_1, B_2, C_2, C_3, u, v, w, rho, xi_d, eta_d, zeta_d, lim)
u_1 = u(:,1); u_2 = u(:,2); u_3 = u(:,3);
v_1 = v(:,1); v_2 = v(:,2); v_3 = v(:,3);
w_1 = w(:,1); w_2 = w(:,2); w_3 = w(:,3);

t1 = (E .^ 2);
t9 = (-u_1 .* zeta_d + w_1 .* xi_d) .* (t1 .* A_1 + 2 .* C_2 .* E + B_1);
t10 = xi_1 .^ 2;
t11 = (t10 .^ 2);
t18 = A_1 .* D_TE;
t20 = A_2 .* u_1;
t21 = u_2 .* C_2;
t31 = zeta_d .* (A_1 .* u_2 .* t1 + 2 .* E .* (u_1 .* t18 + t20 + t21) + 2 .* C_2 .* D_TE .* u_1 + u_2 .* B_1 + 2 .* B_2 .* u_1);
t35 = w_1 .* A_2;
t36 = w_2 .* C_2;
t46 = (A_1 .* w_2 .* t1 + 2 .* E .* (w_1 .* t18 + t35 + t36) + 2 .* w_1 .* D_TE .* C_2 + 2 .* w_1 .* B_2 + w_2 .* B_1) .* xi_d;
t50 = (xi_3 .^ 2);
t53 = t31 - t46;
t60 = u_2 .* A_2;
t61 = u_3 .* C_2;
t64 = D_TE .^ 2;
t65 = A_1 .* t64;
t77 = zeta_d .* (0.4e1 ./ 0.3e1 .* A_1 .* u_3 .* t1 + 0.8e1 ./ 0.3e1 .* E .* (u_2 .* D_TE .* A_1 + t60 + t61) + 0.4e1 ./ 0.3e1 .* u_1 .* t65 + 0.8e1 ./ 0.3e1 .* D_TE .* (t20 + t21) + 0.8e1 ./ 0.3e1 .* u_2 .* B_2 + 0.4e1 ./ 0.3e1 .* u_3 .* B_1 + 0.8e1 ./ 0.3e1 .* C_3 .* u_1);
t81 = w_2 .* A_2;
t82 = w_3 .* C_2;
t96 = 0.4e1 ./ 0.3e1 .* (A_1 .* w_3 .* t1 + 2 .* E .* (w_2 .* t18 + t81 + t82) + A_1 .* t64 .* w_1 + 2 .* D_TE .* (t35 + t36) + 2 .* w_1 .* C_3 + 2 .* w_2 .* B_2 + w_3 .* B_1) .* xi_d;
t99 = (t50 .* xi_3);
t103 = t77 - t96;
t105 = t18 + A_2;
t119 = zeta_d .* (4 .* E .* t105 .* u_3 + 2 .* A_1 .* t64 .* u_2 + 4 .* D_TE .* (t60 + t61) + 4 .* u_2 .* C_3 + 4 .* u_3 .* B_2);
t131 = 0.4e1 .* ((E .* t105 .* w_3) + (A_1 .* t64 .* w_2) ./ 0.2e1 + (D_TE .* (t81 + t82)) + (w_2 .* C_3) + (w_3 .* B_2)) .* xi_d;
t134 = (t50 .^ 2);
t154 = rho .* (xi_1 - xi_3) .* (-0.4e1 ./ 0.5e1 .* t11 .* t9 + t10 .* xi_1 .* (-0.4e1 ./ 0.5e1 .* xi_3 .* t9 + t31 - t46) + t10 .* (-0.4e1 ./ 0.5e1 .* t50 .* t9 + (xi_3 .* t53) + t77 - t96) + xi_1 .* (-0.4e1 ./ 0.5e1 .* t99 .* t9 + (t50 .* t53) + xi_3 .* t103 + t119 - t131) - 0.4e1 ./ 0.5e1 .* t134 .* t9 + (t99 .* t53) + t50 .* t103 + xi_3 .* (t119 - t131) + (4 .* (u_3 .* zeta_d - w_3 .* xi_d) .* (2 .* A_2 .* D_TE + 2 .* C_3 + t65))) ./ 0.8e1;

v_out = t154;

end
