function I = fcnK2_new(S, T, u, alpha, F_1, F_2, tol)
t1 = 0.1e1 ./ S;
t2 = (S .* u);
t4 = (T .^ 2);
t5 = -4 .* t2 + t4;
t6 = sqrt(t5);
t7 = -T + t6;
t9 = t7 .* t1 ./ 0.2e1;
t11 = sqrt(-t6);
t12 = 0.1e1 ./ t11;
t13 = S .^ 2;
t14 = (alpha .* t13);
t15 = 2 .* t14;
t16 = t6 .* T;
t17 = 2 .* t2;
t18 = t15 + t16 - t17 + t4;
t20 = t17 - t4;
t22 = T .* t4;
t23 = T .* S;
t24 = u .* t23;
t25 = 0.4e1 .* t24;
t26 = t6 .* t20 + t22 - t25;
t28 = 1 ./ t5;
t29 = alpha .^ 2;
t30 = t29 .* t13;
t31 = S .* alpha;
t33 = 0.2e1 .* u .* t31;
t34 = t4 .* alpha;
t35 = u .^ 2;
t37 = 0.1e1 ./ (t30 - t33 + t34 + t35);
t38 = t37 .* t28;
t39 = t15 - t16 - t17 + t4;
t40 = 0.1e1 ./ t39;
t43 = sign(t40 .* t38 .* t26 .* t18 .* t12);
t45 = T + t6;
t47 = t1 .* t45 ./ 0.2e1;
t50 = -t6 .* t20 + t22 - t25;
t52 = t5 .^ (0.1e1 ./ 0.4e1);
t55 = t37 ./ t52 ./ t5;
t56 = 0.1e1 ./ t18;
t59 = sign(t56 .* t55 .* t39 .* t50);
t62 = sqrt(alpha);
t63 = -i .* t62 .* T;
t64 = -t31 + t63 + u;
t65 = t64 .^ 2;
t66 = sqrt(t64);
t68 = 0.1e1 ./ t66 ./ t65;
t69 = F_2 .^ 2;
t71 = T .* F_2;
t73 = sqrt(S .* t69 + t71 + u);
t76 = t66 .* t5;
t77 = t13 .^ 2;
t78 = S .* t77;
t79 = u .* t35;
t80 = t79 .* t78;
t82 = t4 .* t77;
t83 = t35 .* t82;
t85 = S .* t13;
t86 = t4 .^ 2;
t87 = t86 .* t85;
t90 = t4 .* t86;
t91 = t90 .* t13;
t93 = -0.24e2 .* u .* t87 - 0.56e2 .* t80 + 0.60e2 .* t83 + 0.4e1 .* t91;
t95 = t86 .^ 2;
t97 = u .* S .* t90;
t98 = 0.8e1 .* t97;
t99 = t13 .* t86;
t100 = t35 .* t99;
t101 = 0.36e2 .* t100;
t102 = t85 .* t4;
t103 = t79 .* t102;
t104 = 0.80e2 .* t103;
t105 = t35 .^ 2;
t106 = t105 .* t77;
t107 = 0.70e2 .* t106;
t110 = t29 .^ 2;
t112 = t62 .* alpha .* t110;
t115 = t107 - t104 + t101 - t98 + t95;
t118 = 0.4e1 .* t35 .* t90;
t119 = S .* t86;
t121 = 0.24e2 .* t79 .* t119;
t122 = t13 .* t4;
t124 = 0.60e2 .* t105 .* t122;
t125 = u .* t105;
t127 = 0.56e2 .* t125 .* t85;
t130 = t62 .* t110;
t133 = t79 .* t85;
t134 = 0.14e2 .* t133;
t135 = t35 .* t122;
t136 = 0.15e2 .* t135;
t137 = u .* t119;
t138 = 0.6e1 .* t137;
t139 = -t134 + t136 - t138 + t90;
t141 = S .* t4;
t143 = 0.6e1 .* t79 .* t141;
t145 = 0.7e1 .* t13 .* t105;
t147 = 0.3e1 ./ 0.2e1 .* t35 .* t86;
t150 = alpha .* t29;
t151 = t62 .* t150;
t152 = t151 .* t35;
t155 = u .* t102;
t157 = t35 .* t77;
t159 = 0.3e1 ./ 0.2e1 .* t99 - 0.6e1 .* t155 + 0.7e1 .* t157;
t164 = t62 .* t29 .* t110;
t165 = t164 .* T;
t167 = t85 .* t77;
t171 = t13 .* t77;
t173 = -0.2e1 .* u .* T .* t167 + t171 .* t22;
t175 = T .* t86;
t177 = 0.3e1 ./ 0.2e1 .* t77 .* t175;
t180 = 0.6e1 .* u .* t78 .* t22;
t181 = t171 .* T;
t183 = 0.7e1 .* t35 .* t181;
t186 = t62 .* t150 .* t110;
t188 = t105 .* t175;
t190 = S .* t22;
t193 = t13 .* T;
t194 = t35 .* t105;
t195 = t194 .* t193;
t197 = 0.3e1 ./ 0.2e1 .* t188 - 0.6e1 .* t125 .* t190 + 0.7e1 .* t195;
t199 = t194 .* t22;
t201 = t79 .* t105 .* t23;
t202 = 0.2e1 .* t201;
t204 = t62 .* t29;
t207 = t35 ./ 0.4e1;
t210 = t62 .* alpha;
t211 = t210 .* t194;
t213 = t69 .* t13;
t216 = t110 .^ 2;
t217 = t62 .* t216;
t221 = t62 .* alpha .* t216;
t223 = t77 .^ 2;
t224 = t223 .* t221 .* T;
t225 = t224 ./ 0.4e1;
t226 = t105 .^ 2;
t227 = t226 .* T;
t229 = t62 .* t69 .* t227;
t232 = t31 + u ./ 0.2e1;
t233 = t31 - u;
t234 = t233 .^ 2;
t236 = (t234 + t34) .^ 2;
t237 = t236 .^ 2;
t238 = t237 .* t232;
t239 = t69 + alpha;
t241 = (t112 .* (t69 .* t93 + t101 - t104 + t107 + t95 - t98) .* T ./ 0.4e1) + (t130 .* (t69 .* t115 + t118 - t121 + t124 - t127) .* T ./ 0.4e1) + (t152 .* T .* (t69 .* t139 - t143 + t145 + t147)) + (t165 .* t13 .* (t69 .* t159 - t134 + t136 - t138 + t90)) + (t186 .* (t69 .* t173 + t177 - t180 + t183)) + (t204 .* (t69 .* t197 + t199 - t202)) + (t211 .* T .* (-t69 .* t20 + t207)) + (t217 .* (t213 ./ 0.4e1 - t17 + t4) .* t181) + t225 + (t229 ./ 0.4e1) + i .* t239 .* t238;
t243 = -2.*i .* S;
t247 = -t31 + i .* t62 .* T + u;
t248 = sqrt(t247);
t251 = 0.2e1 .* u;
t256 = log(0.1e1 ./ (i .* t62 - F_2) .* (t62 .* F_2 .* t243 - 2 .* t73 .* t248 - t251 + t63 - t71));
t260 = 0.168e3 .* t106;
t264 = -t260 + 0.70e2 .* t103 + 0.9e1 .* t100 - 0.6e1 .* t97 + t95;
t265 = t264 .* t13;
t266 = F_2 .* t69;
t273 = 0.28e2 .* t106 + 0.25e2 .* t103 - 0.12e2 .* t100 - 0.5e1 .* t97 + t95;
t276 = t125 .* t78;
t277 = 0.168e3 .* t276;
t278 = t105 .* t82;
t280 = t79 .* t87;
t282 = t35 .* t91;
t285 = u .* t95 .* S;
t287 = t4 .* t95;
t288 = -t277 - 0.28e2 .* t278 + 0.67e2 .* t280 - 0.6e1 .* t282 - 0.7e1 .* t285 + t287;
t290 = T .* u;
t296 = (-0.280e3 .* t106 + 0.145e3 .* t103 + 0.6e1 .* t100 - 0.13e2 .* t97 + t95) .* t290;
t307 = (-0.840e3 .* t276 + 0.350e3 .* t278 + 0.64e2 .* t280 - 0.36e2 .* t282 - 0.4e1 .* t285 + t287) .* S;
t314 = 0.6e1 .* t285;
t316 = (-0.280e3 .* t276 + 0.60e2 .* t278 + 0.52e2 .* t280 - 0.10e2 .* t282 - t314 + t287) .* T;
t322 = (-t277 - 0.126e3 .* t278 + 0.106e3 .* t280 - t314 + t287) .* u;
t332 = 0.4e1 .* t35 .* (t95 - 0.17e2 ./ 0.3e1 .* t97 + 0.2e1 .* t100 + 0.55e2 .* t103 - 0.308e3 ./ 0.3e1 .* t106) .* T;
t335 = t264 .* S;
t342 = (t95 - 0.13e2 ./ 0.2e1 .* t97 + 0.21e2 ./ 0.2e1 .* t100 + 0.77e2 ./ 0.2e1 .* t103 - 0.98e2 .* t106) .* T;
t344 = u .* t4;
t345 = 0.56e2 .* t133;
t347 = t345 - 0.21e2 .* t135 - t137 + t90;
t356 = 0.3e1 ./ 0.2e1 .* (t90 + t137 - 0.33e2 .* t135 + 0.196e3 ./ 0.3e1 .* t133) .* t35 .* T;
t364 = 0.168e3 .* t80 - 0.70e2 .* t83 + 0.3e1 .* t91;
t366 = T .* t77;
t375 = -0.3e1 .* u .* t175 .* t13 + 0.29e2 .* t35 .* t22 .* t85 - 0.28e2 .* t79 .* t366;
t379 = -t260 + 0.14e2 .* t103 + 0.39e2 .* t100 - t98 + t95;
t385 = (-0.140e3 .* t133 + 0.63e2 .* t135 - 0.3e1 .* t137 + t90) .* t290;
t393 = -0.2e1 ./ 0.3e1 .* t99 + 0.20e2 ./ 0.3e1 .* t155 - 0.16e2 .* t157;
t403 = S .* t175 ./ 0.3e1 - 0.3e1 .* u .* t13 .* t22 + 0.20e2 ./ 0.3e1 .* t35 .* t85 .* T;
t408 = t90 - 0.7e1 ./ 0.3e1 .* t137 - 0.8e1 .* t135 + 0.32e2 .* t133;
t410 = u .* t141;
t412 = t35 .* t13;
t415 = (t86 - 0.3e1 .* t410 + 0.28e2 ./ 0.3e1 .* t412) .* t290;
t422 = (t90 - 0.70e2 ./ 0.3e1 .* t135 + t345) .* S;
t427 = (t90 - t137 - 0.61e2 ./ 0.3e1 .* t135 + 0.140e3 ./ 0.3e1 .* t133) .* T;
t435 = 0.5e1 ./ 0.3e1 .* t35 .* t119 - 0.26e2 ./ 0.3e1 .* t79 .* t122 + 0.8e1 .* t105 .* t85;
t437 = t35 .* t175;
t439 = 0.29e2 ./ 0.3e1 .* t79 .* t190;
t441 = 0.68e2 ./ 0.3e1 .* t105 .* t193;
t450 = -0.10e2 .* u .* t122 + 0.24e2 .* t35 .* t85 + t119;
t456 = t175 - 0.21e2 ./ 0.2e1 .* u .* t190 + 0.26e2 .* t35 .* t193;
t458 = u .* t86;
t464 = t458 ./ 0.2e1 - 0.3e1 .* t35 .* t141 + 0.6e1 .* t79 .* t13;
t467 = 0.3e1 ./ 0.2e1 .* t35 .* t22;
t469 = 0.5e1 .* t79 .* t23;
t475 = t85 .* u;
t477 = 0.5e1 ./ 0.2e1 .* t122 - 0.6e1 .* t475;
t482 = -t190 ./ 0.2e1 + 0.4e1 .* u .* t193;
t486 = 0.30e2 .* t412 + t86 - 0.23e2 ./ 0.2e1 .* t410;
t488 = u .* t22;
t490 = 0.4e1 .* t35 .* t23;
t495 = S .* t223;
t503 = t141 - 0.12e2 ./ 0.5e1 .* u .* t13;
t506 = t22 - 0.16e2 ./ 0.5e1 .* t24;
t509 = t5 .* u ./ 0.5e1;
t512 = t62 .* t226;
t515 = t86 .* alpha;
t523 = (t515 + t4 .* (-0.5e1 .* t30 - t33 - 0.5e1 .* t35) + 0.12e2 .* t234 .* t2) .* S;
t530 = t85 .* t29;
t538 = T .* (t515 + t4 .* (t31 + u) .* (t31 - 0.5e1 .* u) - 0.8e1 .* u .* t530 - 0.8e1 .* t35 .* t14 + 0.16e2 .* t79 .* S);
t542 = u .* alpha;
t560 = t86 .* (0.2e1 .* t29 .* S - t542) + t4 .* (-0.4e1 .* t85 .* t150 - 0.9e1 .* u .* t30 + 0.2e1 .* t35 .* t31 - t79) + 0.8e1 .* u .* t150 .* t77 - 0.12e2 .* t35 .* t530 + 0.4e1 .* t105 .* S;
t573 = 0.2e1 .* t542 .* T .* (t4 .* (t31 - 0.3e1 .* u) - 0.2e1 .* t530 - 0.8e1 .* u .* t14 + 0.10e2 .* t35 .* S);
t578 = alpha .* t236 .* t233;
t580 = (0.4e1 ./ 0.3e1 .* t112 .* S .* (t69 .* t273 .* t23 + F_2 .* t288 - 0.2e1 .* t266 .* t265 + t296)) + (t130 .* (0.2e1 ./ 0.3e1 .* t266 .* t307 + 0.2e1 ./ 0.3e1 .* t69 .* t316 - 0.2e1 ./ 0.3e1 .* F_2 .* t322 - t332)) - (0.8e1 ./ 0.3e1 .* t151 .* t35 .* (t266 .* t335 + t69 .* t342 + F_2 .* t347 .* t344 ./ 0.2e1 + t356)) - (0.4e1 ./ 0.3e1 .* t164 .* (F_2 .* t379 + t266 .* t364 + t69 .* t375 + t385) .* t85) - (0.4e1 .* t186 .* t78 .* (F_2 .* t408 + t266 .* t393 + t69 .* t403 + t415)) - (0.4e1 .* t204 .* t105 .* (F_2 .* t435 + t266 .* t422 + t69 .* t427 - t437 + t439 - t441)) + (0.8e1 ./ 0.3e1 .* t210 .* t194 .* (F_2 .* t464 + t266 .* t450 + t69 .* t456 + t467 - t469)) + (0.4e1 ./ 0.3e1 .* t217 .* (F_2 .* t486 + t266 .* t477 + t69 .* t482 + t488 - t490) .* t167) + (0.8e1 ./ 0.3e1 .* t221 .* (-F_2 .* t20 + t290) .* t495) + (0.10e2 ./ 0.3e1 .* t512 .* (F_2 .* t506 + t69 .* t503 + t509) .* F_2) + 0.4e1 ./ 0.3e1.*i .* t578 .* T .* (F_2 .* t560 + t266 .* t523 + t69 .* t538 + t573);
t594 = log(0.1e1 ./ (F_2 + i .* t62) .* (2 .* t73 .* t66 + -i .* t62 .* (0.2e1 .* F_2 .* S + T) + t71 + t251));
t598 = 0.336e3 .* t80 - 0.180e3 .* t83 + 0.12e2 .* t91;
t600 = 0.160e3 .* t103;
t601 = 0.210e3 .* t106;
t606 = -t601 + t600 - t101 + t95;
t611 = 0.5e1 .* t412 - 0.4e1 .* t410 + t86;
t613 = 0.12e2 .* t611 .* t35 .* t4;
t618 = t611 .* t4;
t627 = t99 ./ 0.2e1 + 0.8e1 .* t155 - 0.21e2 .* t157;
t629 = 0.28e2 .* t133;
t636 = -0.10e2 ./ 0.3e1 .* t122 + 0.16e2 .* t475;
t638 = 0.16e2 .* t410;
t639 = 0.42e2 .* t412;
t645 = -0.14e2 .* t195 + 0.3e1 .* t188;
t647 = 0.8e1 .* t201;
t648 = 0.2e1 ./ 0.3e1 .* t199;
t652 = -12 .* t2 + t4;
t654 = 0.9e1 ./ 0.4e1 .* t35;
t660 = 0.24e2 ./ 0.5e1 .* t2;
t663 = t217 .* T;
t666 = 0.5e1 ./ 0.2e1 .* t224;
t674 = t234 .^ 2;
t678 = t236 .* (t29 .* t458 - 0.10e2 ./ 0.3e1 .* t34 .* (t31 + 0.4e1 ./ 0.5e1 .* u) .* t234 + 0.2e1 ./ 0.3e1 .* t232 .* t674);
t680 = -(t112 .* (t69 .* t598 - t101 + t600 - t601 + t95) .* T ./ 0.6e1) - (t130 .* (t69 .* t606 - t613) .* T ./ 0.6e1) + (0.2e1 .* t152 .* (t69 .* t618 - t145 + t147) .* T) - (0.2e1 .* t165 .* t13 .* (t69 .* t627 - t136 + t629 + t90)) - (t186 .* (t69 .* t636 + t638 - t639 + t86) .* t366) + (t204 .* (t69 .* t645 + t647 - t648)) - (0.2e1 ./ 0.3e1 .* t211 .* (t69 .* t652 + t654) .* T) + (0.10e2 ./ 0.3e1 .* t663 .* t171 .* (0.3e1 ./ 0.4e1 .* t213 + t4 - t660)) + t666 - (0.3e1 ./ 0.2e1 .* t229) + i .* t239 .* t678;
t687 = t247 .^ 2;
t688 = t687 .^ 2;
t692 = t28 ./ t248 ./ t687 ./ t688;
t694 = t151 .* t13 ./ 0.2e1;
t696 = t4 ./ 0.2e1;
t702 = t35 ./ 0.2e1;
t708 = alpha .* t233;
t716 = piecewise(t9 == F_2, inf .* t43, -t47 == F_2, inf .* t59, -(0.3e1 ./ 0.8e1) ./ (t694 + (t204 .* (t213 ./ 0.2e1 - t696 - t2)) + (t210 .* (-t69 .* t4 ./ 0.2e1 - t69 .* t2 + t702)) + (t62 .* t69 .* t35 ./ 0.2e1) + i .* t239 .* T .* t708) .* t692 .* (-(0.2e1 ./ 0.3e1) .* t256 .* t241 .* t73 .* t76 + t248 .* (t680 .* t594 .* t73 .* t5 + t66 .* t580)) ./ t73 .* t68);
t717 = real(-t7);
t719 = t717 .* t1 ./ 0.2e1;
t722 = And(F_1 < -t719, -t719 < F_2);
t726 = sign(t40 .* t55 .* t26 .* t18);
t729 = piecewise(t722, (-t726 + t43) .* inf, 0);
t730 = real(t45);
t732 = t730 .* t1 ./ 0.2e1;
t735 = And(F_1 < -t732, -t732 < F_2);
t740 = sign(t56 .* t38 .* t39 .* t12 .* t50);
t743 = piecewise(t735, (-t740 + t59) .* inf, 0);
t748 = F_1 .^ 2;
t750 = T .* F_1;
t752 = sqrt(S .* t748 + t750 + u);
t783 = t748 .* t13;
t789 = t62 .* t748 .* t227;
t791 = t748 + alpha;
t793 = (t112 .* (t748 .* t93 + t101 - t104 + t107 + t95 - t98) .* T ./ 0.4e1) + (t130 .* (t748 .* t115 + t118 - t121 + t124 - t127) .* T ./ 0.4e1) + (t152 .* T .* (t748 .* t139 - t143 + t145 + t147)) + (t165 .* t13 .* (t748 .* t159 - t134 + t136 - t138 + t90)) + (t186 .* (t748 .* t173 + t177 - t180 + t183)) + (t204 .* (t748 .* t197 + t199 - t202)) + (t211 .* T .* (-t748 .* t20 + t207)) + (t217 .* (t783 ./ 0.4e1 - t17 + t4) .* t181) + t225 + (t789 ./ 0.4e1) + i .* t791 .* t238;
t803 = log(0.1e1 ./ (i .* t62 - F_1) .* (t62 .* F_1 .* t243 - 2 .* t752 .* t248 - t251 + t63 - t750));
t807 = F_1 .* t748;
t887 = (0.4e1 ./ 0.3e1 .* t112 .* S .* (t748 .* t273 .* t23 + F_1 .* t288 - 0.2e1 .* t807 .* t265 + t296)) + (t130 .* (0.2e1 ./ 0.3e1 .* t807 .* t307 + 0.2e1 ./ 0.3e1 .* t748 .* t316 - 0.2e1 ./ 0.3e1 .* F_1 .* t322 - t332)) - (0.8e1 ./ 0.3e1 .* t151 .* t35 .* (t807 .* t335 + t748 .* t342 + F_1 .* t347 .* t344 ./ 0.2e1 + t356)) - (0.4e1 ./ 0.3e1 .* t164 .* (F_1 .* t379 + t807 .* t364 + t748 .* t375 + t385) .* t85) - (0.4e1 .* t186 .* t78 .* (F_1 .* t408 + t807 .* t393 + t748 .* t403 + t415)) - (0.4e1 .* t204 .* t105 .* (F_1 .* t435 + t807 .* t422 + t748 .* t427 - t437 + t439 - t441)) + (0.8e1 ./ 0.3e1 .* t210 .* t194 .* (F_1 .* t464 + t807 .* t450 + t748 .* t456 + t467 - t469)) + (0.4e1 ./ 0.3e1 .* t217 .* (F_1 .* t486 + t807 .* t477 + t748 .* t482 + t488 - t490) .* t167) + (0.8e1 ./ 0.3e1 .* t221 .* (-F_1 .* t20 + t290) .* t495) + (0.10e2 ./ 0.3e1 .* t512 .* (F_1 .* t506 + t748 .* t503 + t509) .* F_1) + 0.4e1 ./ 0.3e1.*i .* t578 .* T .* (F_1 .* t560 + t807 .* t523 + t748 .* t538 + t573);
t901 = log(0.1e1 ./ (F_1 + i .* t62) .* (2 .* t752 .* t66 + -i .* t62 .* (0.2e1 .* F_1 .* S + T) + t750 + t251));
t941 = -(t112 .* (t748 .* t598 - t101 + t600 - t601 + t95) .* T ./ 0.6e1) - (t130 .* (t748 .* t606 - t613) .* T ./ 0.6e1) + (0.2e1 .* t152 .* (t748 .* t618 - t145 + t147) .* T) - (0.2e1 .* t165 .* t13 .* (t748 .* t627 - t136 + t629 + t90)) - (t186 .* (t748 .* t636 + t638 - t639 + t86) .* t366) + (t204 .* (t748 .* t645 + t647 - t648)) - (0.2e1 ./ 0.3e1 .* t211 .* (t748 .* t652 + t654) .* T) + (0.10e2 ./ 0.3e1 .* t663 .* t171 .* (0.3e1 ./ 0.4e1 .* t783 + t4 - t660)) + t666 - (0.3e1 ./ 0.2e1 .* t789) + i .* t791 .* t678;
t966 = piecewise(t9 == F_1, inf .* t726, -t47 == F_1, inf .* t740, -(0.3e1 ./ 0.8e1) ./ (t694 + (t204 .* (t783 ./ 0.2e1 - t696 - t2)) + (t210 .* (-t748 .* t4 ./ 0.2e1 - t748 .* t2 + t702)) + (t62 .* t748 .* t35 ./ 0.2e1) + i .* t791 .* T .* t708) .* t692 .* (-(0.2e1 ./ 0.3e1) .* t803 .* t793 .* t752 .* t76 + t248 .* (t941 .* t901 .* t752 .* t5 + t66 .* t887)) ./ t752 .* t68);
t967 = t716 - t966;

I = t967;

end
