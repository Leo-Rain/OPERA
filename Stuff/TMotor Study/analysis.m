clc
clear

fileList = dir('Results/*.mat');

for i = 1:size(fileList,1)
    load(['Results/', fileList(i).name], 'CT', 'J', 'jj')
    CT_all(:,i) = CT;
    J_all(:,i) = J(jj);
end

hFig1 = figure(1);
clf(1);
scatter(J_all(1:end), CT_all(end,1:end), 'sb');
grid minor
box on
axis tight
xlabel('J');
ylabel('C_T');

fw_fixed = [ 0	0.008421754105;...
0.03183098862	0.005658531172;...
0.04774648293	0.006003732884;...
0.06366197724	0.005882723846;...
0.07957747155	0.005435878267;...
0.09549296586	0.004756671798;...
0.1114084602	0.003908846876;...
0.1273239545	0.002937200099;...
0.1432394488	0.001865059645;...
0.1591549431	0.0007197984282];

tunnel = [0.0519	0.0078;...
0.0582	0.0072;...
0.0639	0.0068;...
0.0704	0.0064;...
0.0766	0.0059;...
0.0827	0.0055;...
0.0892	0.0049;...
0.0957	0.0045;...
0.1026	0.0038;...
0.1093	0.0033;...
0.116	0.0027;...
0.1228	0.0021;...
0.1303	0.0014;...
0.1368	0.0007];

hold on
plot(fw_fixed(:,1), fw_fixed(:,2), '-.^k')
plot(tunnel(:,1), tunnel(:,2), '-om')
hold off

legend('OPERA','FW','Tunnel','Location','SouthWest')

% hFig1 = figure(1);
% clf(1);
% plot(CT_all, '-k');
% grid minor
% box on
% axis tight
% xlabel('Timestep');
% ylabel('C_T');