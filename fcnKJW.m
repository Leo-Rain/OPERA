function [w_out] = fcnKJW(xi_1, xi_3, eta_1, eta_3, E, D_TE, A_1, A_2, B_1, B_2, C_2, C_3, u, v, w, rho, lim)
u_1 = u(:,1); u_2 = u(:,2); u_3 = u(:,3);
v_1 = v(:,1); v_2 = v(:,2); v_3 = v(:,3);
w_1 = w(:,1); w_2 = w(:,2); w_3 = w(:,3);

t1 = -xi_3 + xi_1;
t2 = (xi_1 + xi_3);
t3 = xi_1 .^ 2;
t4 = xi_3 .^ 2;
t5 = (t3 + t4);
t6 = (t5 .* t2);
t9 = t3 .^ 2;
t15 = t4 .^ 2;
t16 = (xi_3 .* t3 .* xi_1 + t4 .* xi_3 .* xi_1 + t4 .* t3 + t15 + t9);
t22 = (xi_3 .* xi_1 + t3 + t4);
t24 = t2 .* E;
t25 = t5 .* t24;
t29 = (D_TE .^ 2);
t34 = (E .^ 2);
t44 = -eta_3 + eta_1;
t53 = (t22 .* E);
t89 = u_3 .* (C_2 .* (3 .* D_TE .* t2 + 2 .* t53) + A_2 .* (3 .* t2 .* E + 6 .* D_TE) + A_1 .* (3 .* D_TE .* t24 + t22 .* t34 + 3 .* t29) + B_1 .* t22 + 3 .* B_2 .* t2 + 6 .* C_3);
t98 = (t5 .* v_1 + 2 .* v_3) .* t2;
t100 = 0.10e2 ./ 0.3e1 .* v_2 .* t22 + 0.5e1 ./ 0.2e1 .* t98;
t106 = 0.5e1 ./ 0.4e1 .* v_2 .* t6 + 0.5e1 ./ 0.3e1 .* v_3 .* t22 + (t16 .* v_1);
t118 = E .* (0.4e1 ./ 0.3e1 .* v_2 .* t22 + t98);
t145 = (eta_1 .^ 2);
t148 = (eta_3 .^ 2);
t149 = (t1 .^ 2);
t151 = sqrt((-2 .* eta_3 .* eta_1 + t145 + t148 + t149));
t155 = 0.1e1 ./ t151 .* rho .* (0.4e1 ./ 0.5e1 .* u_1 .* t44 .* (C_2 .* (0.5e1 ./ 0.2e1 .* D_TE .* t6 + (2 .* t16 .* E)) + A_2 .* (0.10e2 ./ 0.3e1 .* D_TE .* t22 + 0.5e1 ./ 0.2e1 .* t25) + A_1 .* (0.5e1 ./ 0.3e1 .* t29 .* t22 + 0.5e1 ./ 0.2e1 .* D_TE .* t5 .* t24 + (t16 .* t34)) + (B_1 .* t16) + 0.5e1 ./ 0.2e1 .* B_2 .* t6 + 0.10e2 ./ 0.3e1 .* t22 .* C_3) + u_2 .* (C_2 .* (0.8e1 ./ 0.3e1 .* D_TE .* t22 + 0.2e1 .* t25) + A_2 .* ((4 .* D_TE .* t2) + 0.8e1 ./ 0.3e1 .* t53) + A_1 .* ((2 .* t29 .* t2) + 0.8e1 ./ 0.3e1 .* D_TE .* t53 + (t5 .* t2 .* t34)) + (B_1 .* t6) + 0.8e1 ./ 0.3e1 .* B_2 .* t22 + (4 .* t2 .* C_3)) .* t44 + 0.4e1 ./ 0.3e1 .* eta_1 .* t89 - 0.4e1 ./ 0.3e1 .* eta_3 .* t89 - 0.4e1 ./ 0.5e1 .* t1 .* (C_2 .* (D_TE .* t100 + 0.2e1 .* E .* t106) + A_2 .* (D_TE .* ((5 .* v_2 .* t2) + (10 .* v_3) + 0.10e2 ./ 0.3e1 .* v_1 .* t22) + 0.5e1 ./ 0.2e1 .* t118) + A_1 .* (t29 .* (0.5e1 ./ 0.2e1 .* v_2 .* t2 + (5 .* v_3) + 0.5e1 ./ 0.3e1 .* v_1 .* t22) + 0.5e1 ./ 0.2e1 .* D_TE .* t118 + t34 .* t106) + B_1 .* t106 + B_2 .* t100 + 0.10e2 ./ 0.3e1 .* (0.3e1 ./ 0.2e1 .* v_2 .* t2 + (3 .* v_3) + (v_1 .* t22)) .* C_3)) .* t1 ./ 0.8e1;

w_out = t155;
end