function [w_out] = fcnKJW(xi_1, xi_3, eta_1, eta_3, E, D_TE, A_1, A_2, B_1, B_2, C_2, C_3, u, v, w, rho, lim)
u_1 = u(:,1); u_2 = u(:,2); u_3 = u(:,3);
v_1 = v(:,1); v_2 = v(:,2); v_3 = v(:,3);
w_1 = w(:,1); w_2 = w(:,2); w_3 = w(:,3);

t1 = (E .^ 2);
t5 = t1 .* A_1 + 2 .* C_2 .* E + B_1;
t6 = t5 .* v_1;
t7 = xi_1 .^ 2;
t8 = (t7 .^ 2);
t13 = 0.4e1 ./ 0.5e1 .* eta_1 .* u_1;
t15 = 0.4e1 ./ 0.5e1 .* eta_3 .* u_1;
t19 = v_1 .* A_2;
t20 = 2 .* t19;
t21 = v_2 .* C_2;
t22 = 2 .* t21;
t23 = D_TE .* v_1;
t25 = 2 .* A_1 .* t23;
t28 = 0.8e1 ./ 0.5e1 .* eta_1 .* C_2 .* u_1;
t31 = 0.8e1 ./ 0.5e1 .* eta_3 .* C_2 .* u_1;
t35 = 2 .* C_2 .* t23;
t38 = 0.4e1 ./ 0.5e1 .* eta_1 .* B_1 .* u_1;
t41 = 0.4e1 ./ 0.5e1 .* eta_3 .* B_1 .* u_1;
t43 = 2 .* v_1 .* B_2;
t44 = v_2 .* B_1;
t47 = t5 .* u_1;
t48 = -eta_3 + eta_1;
t52 = u_2 .* eta_1;
t53 = u_2 .* eta_3;
t54 = 0.4e1 ./ 0.3e1 .* v_3;
t58 = A_1 .* D_TE;
t60 = A_2 .* u_1;
t61 = u_2 .* C_2;
t62 = u_1 .* t58 + t60 + t61;
t63 = 0.2e1 .* eta_1 .* t62;
t64 = -0.2e1 .* eta_3 .* t62;
t67 = 0.8e1 ./ 0.3e1 .* v_2 .* D_TE .* A_1;
t68 = v_2 .* A_2;
t69 = 0.8e1 ./ 0.3e1 .* t68;
t70 = v_3 .* C_2;
t71 = 0.8e1 ./ 0.3e1 .* t70;
t76 = 0.2e1 .* D_TE .* C_2 .* u_1;
t77 = u_2 .* B_1;
t79 = 0.2e1 .* B_2 .* u_1;
t80 = t76 + t77 + t79;
t81 = eta_1 .* t80;
t82 = -eta_3 .* t80;
t83 = D_TE .^ 2;
t86 = 0.4e1 ./ 0.3e1 .* A_1 .* t83 .* v_1;
t87 = -t19 - t21;
t90 = 0.8e1 ./ 0.3e1 .* v_1 .* C_3;
t92 = 0.8e1 ./ 0.3e1 .* v_2 .* B_2;
t94 = 0.4e1 ./ 0.3e1 .* v_3 .* B_1;
t98 = xi_3 .^ 2;
t106 = (A_1 .* u_2 .* t1 + 0.2e1 .* E .* t62 + t76 + t77 + t79) .* t48;
t111 = 0.4e1 ./ 0.3e1 .* t1 .* t48 .* u_3 .* A_1;
t114 = u_2 .* A_2;
t115 = u_3 .* C_2;
t116 = u_2 .* D_TE .* A_1 + t114 + t115;
t117 = 0.8e1 ./ 0.3e1 .* eta_1 .* t116;
t118 = -0.8e1 ./ 0.3e1 .* eta_3 .* t116;
t119 = t58 + A_2;
t121 = 0.4e1 .* t119 .* v_3;
t124 = A_1 .* t83;
t125 = u_1 .* t124;
t126 = 0.4e1 ./ 0.3e1 .* t125;
t127 = t60 + t61;
t129 = u_3 .* B_1;
t130 = 0.4e1 ./ 0.3e1 .* t129;
t131 = C_3 .* u_1;
t132 = 0.8e1 ./ 0.3e1 .* t131;
t133 = u_2 .* B_2;
t134 = 0.8e1 ./ 0.3e1 .* t133;
t136 = eta_1 .* (t126 + 0.8e1 ./ 0.3e1 .* D_TE .* t127 + t130 + t132 + t134);
t139 = eta_3 .* (-t126 - 0.8e1 ./ 0.3e1 .* D_TE .* t127 - t132 - t130 - t134);
t142 = 2 .* A_1 .* t83 .* v_2;
t143 = -t68 - t70;
t146 = 4 .* v_2 .* C_3;
t148 = 0.4e1 .* v_3 .* B_2;
t151 = t98 .* xi_3;
t169 = 0.4e1 .* E .* t119 .* t48 .* u_3;
t172 = 0.2e1 .* A_1 .* t83 .* u_2;
t173 = t114 + t115;
t176 = 0.4e1 .* u_2 .* C_3;
t178 = 0.4e1 .* u_3 .* B_2;
t180 = eta_1 .* (0.4e1 .* D_TE .* t173 + t172 + t176 + t178);
t183 = eta_3 .* (-0.4e1 .* D_TE .* t173 - t172 - t176 - t178);
t187 = 2 .* A_2 .* D_TE + 2 .* C_3 + t124;
t189 = 0.4e1 .* t187 .* v_3;
t192 = t98 .^ 2;
t221 = -0.4e1 ./ 0.5e1 .* t8 .* xi_1 .* t6 + t8 .* (-t1 .* A_1 .* (-t13 + t15 + v_2) + E .* (-t20 - t22 - t25 + t28 - t31) - t35 + t38 - t41 - t43 - t44) + t7 .* xi_1 .* (0.4e1 ./ 0.5e1 .* xi_3 .* t48 .* t47 + t1 .* (t52 - t53 - t54) .* A_1 + E .* (t63 + t64 - t67 - t69 - t71) + t81 + t82 - t86 + 0.8e1 ./ 0.3e1 .* D_TE .* t87 - t90 - t92 - t94) + t7 .* (0.4e1 ./ 0.5e1 .* t98 .* t48 .* t47 + xi_3 .* t106 + t111 + E .* (t117 + t118 - t121) + t136 + t139 - t142 + 0.4e1 .* D_TE .* t143 - t146 - t148) + xi_1 .* (0.4e1 ./ 0.5e1 .* t151 .* t48 .* t47 + t98 .* t106 + 0.4e1 ./ 0.3e1 .* xi_3 .* (A_1 .* u_3 .* t1 + 0.2e1 .* D_TE .* t127 + 0.2e1 .* E .* t116 + t125 + t129 + 0.2e1 .* t131 + 0.2e1 .* t133) .* t48 + t169 + t180 + t183 - t189) + 0.4e1 ./ 0.5e1 .* t192 .* xi_3 .* t6 + t192 .* (t1 .* (v_2 + t13 - t15) .* A_1 + E .* (t20 + t22 + t25 + t28 - t31) + t35 + t38 - t41 + t43 + t44) + t151 .* (t1 .* (t54 + t52 - t53) .* A_1 + E .* (t63 + t64 + t69 + t71 + t67) + t81 + t82 + t86 - 0.8e1 ./ 0.3e1 .* D_TE .* t87 + t90 + t92 + t94) + t98 .* (t111 + E .* (t117 + t118 + t121) + t136 + t139 + t142 - 0.4e1 .* D_TE .* t143 + t146 + t148) + xi_3 .* (t169 + t180 + t183 + t189) + 0.4e1 .* t48 .* t187 .* u_3;
t224 = -rho .* t221 ./ 0.8e1;

w_out = t224;
end