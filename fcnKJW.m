function [w_out] = fcnKJW(xi_1, xi_3, eta_1, eta_3, E, D_TE, A_1, A_2, B_1, B_2, C_2, C_3, u, v, w, rho, xi_d, eta_d, zeta_d, lim)
u_1 = u(:,1); u_2 = u(:,2); u_3 = u(:,3);
v_1 = v(:,1); v_2 = v(:,2); v_3 = v(:,3);
w_1 = w(:,1); w_2 = w(:,2); w_3 = w(:,3);

t1 = (E .^ 2);
t9 = (-eta_d .* u_1 + v_1 .* xi_d) .* (t1 .* A_1 + 2 .* C_2 .* E + B_1);
t10 = xi_1 .^ 2;
t11 = (t10 .^ 2);
t18 = A_1 .* D_TE;
t20 = A_2 .* u_1;
t21 = u_2 .* C_2;
t24 = D_TE .* C_2;
t31 = eta_d .* (A_1 .* u_2 .* t1 + 2 .* E .* (u_1 .* t18 + t20 + t21) + 2 .* u_1 .* t24 + u_2 .* B_1 + 2 .* B_2 .* u_1);
t35 = A_2 .* v_1;
t36 = v_2 .* C_2;
t45 = (A_1 .* v_2 .* t1 + 2 .* E .* (v_1 .* t18 + t35 + t36) + 2 .* v_1 .* t24 + v_2 .* B_1 + 2 .* B_2 .* v_1) .* xi_d;
t49 = (xi_3 .^ 2);
t52 = t31 - t45;
t59 = u_2 .* A_2;
t60 = u_3 .* C_2;
t63 = D_TE .^ 2;
t64 = A_1 .* t63;
t76 = eta_d .* (0.4e1 ./ 0.3e1 .* A_1 .* u_3 .* t1 + 0.8e1 ./ 0.3e1 .* E .* (u_2 .* D_TE .* A_1 + t59 + t60) + 0.4e1 ./ 0.3e1 .* u_1 .* t64 + 0.8e1 ./ 0.3e1 .* D_TE .* (t20 + t21) + 0.8e1 ./ 0.3e1 .* u_2 .* B_2 + 0.4e1 ./ 0.3e1 .* u_3 .* B_1 + 0.8e1 ./ 0.3e1 .* C_3 .* u_1);
t81 = v_2 .* A_2;
t82 = v_3 .* C_2;
t95 = 0.4e1 ./ 0.3e1 .* (A_1 .* v_3 .* t1 + 2 .* E .* (v_2 .* D_TE .* A_1 + t81 + t82) + v_1 .* t64 + 2 .* D_TE .* (t35 + t36) + 2 .* C_3 .* v_1 + 2 .* v_2 .* B_2 + v_3 .* B_1) .* xi_d;
t98 = (t49 .* xi_3);
t102 = t76 - t95;
t104 = t18 + A_2;
t118 = eta_d .* (4 .* E .* t104 .* u_3 + 2 .* A_1 .* t63 .* u_2 + 4 .* D_TE .* (t59 + t60) + 4 .* u_2 .* C_3 + 4 .* u_3 .* B_2);
t130 = 0.4e1 .* ((E .* t104 .* v_3) + (A_1 .* t63 .* v_2) ./ 0.2e1 + (D_TE .* (t81 + t82)) + (v_2 .* C_3) + (v_3 .* B_2)) .* xi_d;
t133 = (t49 .^ 2);
t154 = -rho .* (xi_1 - xi_3) .* (-0.4e1 ./ 0.5e1 .* t11 .* t9 + t10 .* xi_1 .* (-0.4e1 ./ 0.5e1 .* xi_3 .* t9 + t31 - t45) + t10 .* (-0.4e1 ./ 0.5e1 .* t49 .* t9 + (xi_3 .* t52) + t76 - t95) + xi_1 .* (-0.4e1 ./ 0.5e1 .* t98 .* t9 + (t49 .* t52) + xi_3 .* t102 + t118 - t130) - 0.4e1 ./ 0.5e1 .* t133 .* t9 + (t98 .* t52) + t49 .* t102 + xi_3 .* (t118 - t130) + (4 .* (eta_d .* u_3 - v_3 .* xi_d) .* (2 .* A_2 .* D_TE + 2 .* C_3 + t64))) ./ 0.8e1;

w_out = t154;
end