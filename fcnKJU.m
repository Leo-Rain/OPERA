function [u_out] = fcnKJU(xi_1, xi_3, eta_1, eta_3, E, D_TE, A_1, A_2, B_1, B_2, C_2, C_3, u, v, w, rho)
u_1 = u(:,1); u_2 = u(:,2); u_3 = u(:,3);
v_1 = v(:,1); v_2 = v(:,2); v_3 = v(:,3);
w_1 = w(:,1); w_2 = w(:,2); w_3 = w(:,3);

t2 = (E .^ 2);
t3 = t2 + 1;
t4 = t3 .^ 2;
t5 = t3 .* t4;
t6 = sqrt(t3);
t10 = t2 .* A_1;
t11 = (E .* C_2);
t13 = t10 + 2 .* t11 + B_1;
t15 = xi_3 .^ 2;
t16 = (xi_3 .* t15);
t18 = E .* t2;
t22 = C_2 .* t2;
t24 = E .* B_1;
t29 = E .* eta_1;
t30 = t29 + xi_1;
t37 = xi_1 .* B_1;
t39 = B_1 .* t29;
t41 = E .* A_2;
t42 = t41 + B_2;
t43 = t42 .* t3;
t50 = t2 .^ 2;
t61 = D_TE .^ 2;
t63 = t2 ./ 0.2e1;
t72 = 0.2e1 ./ 0.3e1 .* t2;
t78 = E .* xi_1;
t79 = B_1 .* t78;
t87 = E .* B_2;
t95 = xi_1 .^ 2;
t97 = xi_1 .* t29;
t99 = eta_1 .^ 2;
t102 = t95 .* (-0.2e1 ./ 0.3e1 + t2) - 0.10e2 ./ 0.3e1 .* t97 + (-t72 + 0.1e1) .* t99;
t117 = t2 - 0.3e1 ./ 0.2e1;
t121 = eta_1 .* t2;
t122 = A_2 .* t121;
t123 = B_2 .* t29;
t124 = C_3 .* t2;
t135 = E .* t50;
t137 = 0.19e2 ./ 0.6e1 .* t18 + t135 + 0.14e2 ./ 0.3e1 .* E;
t139 = 0.2e1 ./ 0.3e1 .* t50;
t143 = t2 - 0.13e2 ./ 0.2e1;
t144 = t143 .* B_1;
t147 = A_1 .* t137 + C_2 .* (0.8e1 ./ 0.3e1 - t139 - (3 .* t2)) + E .* t144 ./ 0.3e1;
t148 = D_TE .* t61;
t163 = t2 + 16;
t165 = t2 - 0.1e1 ./ 0.2e1;
t175 = t24 .* t143 .* eta_1;
t176 = 0.5e1 ./ 0.2e1 .* E;
t183 = 0.8e1 ./ 0.3e1 .* t3 .* (A_2 .* (t18 + t176) + (-t63 + 0.1e1) .* B_2);
t201 = 12 .* t2;
t214 = t2 - 0.32e2 ./ 0.13e2;
t216 = t95 .* E;
t231 = t99 .* E;
t232 = t144 .* t231;
t240 = E .* C_3;
t242 = 3 .* t3 .* t240;
t255 = (t95 .* (t2 - 0.2e1 ./ 0.13e2) - 0.30e2 ./ 0.13e2 .* t97 + (-0.2e1 ./ 0.13e2 .* t2 + 0.1e1) .* t99) .* t30;
t263 = xi_1 .* t95;
t278 = (t3 .* C_3) ./ 0.2e1;
t285 = t2 - 2;
t291 = t3 .* (A_2 .* t285 .* t29 + B_2 .* t285 .* eta_1 + t242);
t295 = (t16 .* t13 .* t5) + 0.3e1 .* t15 .* t4 .* (D_TE .* (A_1 .* (t18 + 0.8e1 ./ 0.9e1 .* E) + 0.10e2 ./ 0.9e1 .* t22 + t24 ./ 0.9e1 + 0.8e1 ./ 0.9e1 .* C_2) - (A_1 .* t30 .* t2) ./ 0.9e1 - 0.2e1 ./ 0.9e1 .* C_2 .* t30 .* E - t37 ./ 0.9e1 - t39 ./ 0.9e1 + 0.8e1 ./ 0.9e1 .* t43) + 0.3e1 .* xi_3 .* t3 .* (t61 .* (A_1 .* (0.35e2 ./ 0.18e2 .* t2 + t50 + 0.2e1 ./ 0.3e1) + C_2 .* (0.7e1 ./ 0.9e1 .* E + 0.2e1 ./ 0.9e1 .* t18) + (0.1e1 ./ 0.6e1 - t2 ./ 0.9e1) .* B_1) + D_TE .* (-0.2e1 ./ 0.9e1 .* A_1 .* E .* (xi_1 .* (-t63 + 0.2e1) + (t2 + 0.7e1 ./ 0.2e1) .* t29) + C_2 .* (xi_1 .* (-0.4e1 ./ 0.9e1 + t72) - 0.10e2 ./ 0.9e1 .* t29) + 0.5e1 ./ 0.9e1 .* t79 + B_1 .* (0.2e1 ./ 0.9e1 .* t2 - 0.1e1 ./ 0.3e1) .* eta_1 + 0.16e2 ./ 0.9e1 .* t3 .* (A_2 .* (t2 + 0.3e1 ./ 0.4e1) + t87 ./ 0.4e1)) + A_1 .* t2 .* t102 ./ 0.6e1 + C_2 .* E .* t102 ./ 0.3e1 + t95 .* (-0.1e1 ./ 0.9e1 + t2 ./ 0.6e1) .* B_1 + xi_1 .* (-0.5e1 ./ 0.9e1 .* t39 - 0.4e1 ./ 0.9e1 .* t43) - B_1 .* t99 .* t117 ./ 0.9e1 - 0.4e1 ./ 0.9e1 .* (t122 + t123 - 3 .* t124 - 3 .* C_3) .* t3) + t148 .* t147 + t61 .* (A_1 .* (xi_1 .* (0.37e2 ./ 0.6e1 .* t2 - 0.2e1 + t139) - E .* (t50 + t63 + 0.22e2) .* eta_1 ./ 0.3e1) + C_2 .* (xi_1 .* (-0.8e1 ./ 0.3e1 .* t18 + 0.37e2 ./ 0.3e1 .* E) + 0.2e1 ./ 0.3e1 .* t165 .* t163 .* eta_1) + xi_1 .* (-0.16e2 ./ 0.3e1 .* t2 + 0.13e2 ./ 0.6e1) .* B_1 - t175 + t183) + D_TE .* (A_1 .* E .* (t95 .* (t50 + 0.40e2 ./ 0.3e1 .* t2 - 0.8e1 ./ 0.3e1) + 0.16e2 ./ 0.3e1 .* t78 .* (t2 - 0.37e2 ./ 0.8e1) .* eta_1 - 0.2e1 ./ 0.3e1 .* t165 .* t163 .* t99) ./ 0.2e1 + C_2 .* (t95 .* (-0.5e1 ./ 0.3e1 .* t50 - 0.4e1 ./ 0.3e1 + t201) + 0.40e2 ./ 0.3e1 .* t78 .* (t2 - 0.5e1 ./ 0.4e1) .* eta_1 + 0.2e1 ./ 0.3e1 .* (t50 - 0.35e2 ./ 0.2e1 .* t2 + 0.4e1) .* t99) - 0.13e2 ./ 0.6e1 .* t216 .* B_1 .* t214 + xi_1 .* (B_1 .* (-0.13e2 ./ 0.3e1 + 0.32e2 ./ 0.3e1 .* t2) .* eta_1 + (4 .* A_2 .* t50) + (8 .* B_2 .* t18) + (8 .* t87) - (4 .* A_2)) + t232 - 0.4e1 ./ 0.3e1 .* t3 .* (A_2 .* (t2 + 7) .* t29 + B_2 .* eta_1 .* (-2 .* t2 + 4) - t242)) + 0.13e2 ./ 0.6e1 .* t10 .* t255 + 0.13e2 ./ 0.3e1 .* t11 .* t255 + t263 .* (-0.1e1 ./ 0.3e1 + 0.13e2 ./ 0.6e1 .* t2) .* B_1 + t95 .* (0.13e2 ./ 0.6e1 .* t24 .* eta_1 .* t214 + 0.8e1 ./ 0.3e1 .* t42 .* t3 .* t165) + xi_1 .* (-0.16e2 ./ 0.3e1 .* B_1 .* (t2 - 0.13e2 ./ 0.32e2) .* t99 - 0.8e1 .* t3 .* (t122 + t123 + t278)) - 0.4e1 ./ 0.3e1 .* (t232 ./ 0.4e1 + t291) .* eta_1;
t304 = -xi_3 + xi_1;
t305 = t304 .^ 2;
t307 = sqrt(t99 + 0.2e1 .* eta_1 .* (-E .* xi_3 - D_TE) + t61 + 0.2e1 .* D_TE .* E .* xi_3 + t15 .* t2 + t305);
t311 = t2 - 4;
t318 = 2 .* t18;
t320 = t318 - 8 .* E;
t327 = 8 .* t18;
t328 = 12 .* E;
t343 = 4 .* t2;
t355 = xi_1 .* t2;
t375 = t61 .* (A_1 .* t311 - 4 .* B_1 .* t2 + B_1 + 10 .* t11) + D_TE .* (A_1 .* (xi_1 .* t320 - 10 .* t121) + C_2 .* (xi_1 .* (t201 - 8) + eta_1 .* (t327 - t328)) + 10 .* t79 + B_1 .* eta_1 .* (8 .* t2 - 2) + 8 .* (t87 - A_2) .* t3) + (A_1 .* (t95 .* (t50 - t343) - 10 .* eta_1 .* xi_1 .* t18 + t99 .* (-4 .* t50 + t2))) + (C_2 .* (t95 .* t320 - 20 .* eta_1 .* t355 + t99 .* (-t327 + 2 .* E))) + (t95 .* t311 .* B_1) + (xi_1 .* (-10 .* t39 - 8 .* t43)) + (B_1 .* t99 .* (-t343 + 1)) - (8 .* (t122 + t123 + t124 + C_3) .* t3);
t377 = t78 + D_TE - eta_1;
t378 = t377 .^ 2;
t379 = sign(t377);
t383 = 0.1e1 ./ t6;

t385 = log(t383 .* t377 .* (t379 .* t6 + E));
t385(isinf(t385)) = 1e10;

t391 = -0.4e1 + t50 + 0.9e1 ./ 0.2e1 .* t2;
t392 = t391 .* eta_1;
t418 = t95 .* t137 + 0.2e1 ./ 0.3e1 .* xi_1 .* t392 + t143 .* t231 ./ 0.3e1;
t445 = t15 .^ 2;
t474 = t2 + 0.1e1 ./ 0.6e1;
t493 = A_2 .* t2;
t497 = eta_1 .* B_1;
t499 = 0.2e1 ./ 0.3e1 .* A_2;
t505 = t95 .* t474 .* w_1;
t507 = eta_1 .* w_1 .* t78;
t510 = t99 .* w_1;
t512 = t505 - 0.5e1 ./ 0.2e1 .* t507 + 0.5e1 ./ 0.3e1 .* w_3 + 0.5e1 ./ 0.3e1 .* t510;
t518 = B_1 .* w_1;
t527 = t510 + w_3;
t528 = 0.5e1 ./ 0.3e1 .* B_1 .* t527;
t531 = 0.20e2 ./ 0.3e1 .* w_1 .* (t122 + t123 - t278);
t534 = E .* A_1;
t544 = t78 - eta_1;
t546 = 0.3e1 ./ 0.2e1 .* t41;
t548 = B_2 ./ 0.2e1;
t554 = t505 - 0.2e1 .* t507 + t510 + w_3;
t563 = 0.5e1 .* t510;
t564 = 0.5e1 .* w_3;
t569 = 0.2e1 ./ 0.3e1 .* t87;
t570 = t497 ./ 0.3e1;
t573 = A_2 .* t29;
t575 = eta_1 .* B_2;
t581 = t512 .* xi_1;
t590 = w_1 .* (-t39 + t42 .* (t2 + 0.1e1 ./ 0.3e1));
t601 = 0.5e1 .* A_2 .* t527 .* E;
t602 = 0.5e1 .* B_2 .* t527;
t605 = 0.10e2 .* C_3 .* w_1 .* t29;
t606 = 0.10e2 .* t148 .* (t534 + C_2 ./ 0.2e1) .* w_1 + 0.10e2 .* t61 .* w_1 .* (A_1 .* (t355 - 0.3e1 ./ 0.2e1 .* t29 - xi_1 ./ 0.3e1) + (C_2 .* t544) + t546 + t37 ./ 0.6e1 + t548) + D_TE .* (0.5e1 .* A_1 .* E .* t554 + C_2 .* (t95 .* (0.5e1 ./ 0.6e1 + 0.15e2 ./ 0.2e1 .* t2) .* w_1 - 0.40e2 ./ 0.3e1 .* t507 + t563 + t564) + 0.10e2 .* ((B_1 .* t216) ./ 0.4e1 + xi_1 .* (t493 + t569 - t570 - t499) - (2 .* t573) + t240 - t575) .* w_1) + t10 .* t581 + 0.2e1 .* t11 .* t581 + t263 .* t474 .* t518 + 0.5e1 ./ 0.2e1 .* t95 .* t590 + xi_1 .* (t528 - 0.20e2 ./ 0.3e1 .* w_1 .* (t122 - t124 ./ 0.2e1 + t123 + C_3)) + t601 + t602 - t605;
t608 = t61 .^ 2;
t672 = t512 .* t95;
t676 = t95 .^ 2;
t687 = t445 .* t13 .* t3 .* w_1 + t16 .* w_1 .* (D_TE .* (A_1 .* ((5 .* t18) + t176) + 0.15e2 ./ 0.2e1 .* t22 + 0.5e1 ./ 0.2e1 .* t24 + 0.5e1 ./ 0.2e1 .* C_2) + A_1 .* t2 .* (xi_1 .* t117 - 0.5e1 ./ 0.2e1 .* t29) + (C_2 .* (xi_1 .* (t318 - 3 .* E) - 5 .* t121)) + xi_1 .* B_1 .* t117 - 0.5e1 ./ 0.2e1 .* t39 + 0.5e1 ./ 0.2e1 .* t43) + t15 .* (0.10e2 .* t61 .* w_1 .* (A_1 .* t474 + t11 + B_1 ./ 0.6e1) + 0.5e1 .* D_TE .* w_1 .* (A_1 .* E .* (xi_1 .* (t2 - 0.5e1 ./ 0.6e1) - (2 .* t29)) + C_2 .* (xi_1 .* (0.3e1 ./ 0.2e1 .* t2 - 0.5e1 ./ 0.6e1) - 0.8e1 ./ 0.3e1 .* t29) + (2 .* t493) + t79 ./ 0.2e1 + 0.4e1 ./ 0.3e1 .* t87 - 0.2e1 ./ 0.3e1 .* t497 + t499) + A_1 .* t2 .* t512 + 0.2e1 .* C_2 .* E .* t512 + t95 .* t474 .* t518 + 0.5e1 ./ 0.2e1 .* xi_1 .* w_1 .* (-t39 + t42 .* (t2 - 0.5e1 ./ 0.3e1)) + t528 - t531) + xi_3 .* t606 + 0.5e1 .* w_1 .* A_1 .* t608 + 0.10e2 .* t148 .* w_1 .* ((A_1 .* t544) + (xi_1 .* C_2) ./ 0.2e1 + A_2) + t61 .* (A_1 .* (t95 .* (0.5e1 ./ 0.3e1 + (10 .* t2)) .* w_1 - 0.15e2 .* t507 + t563 + t564) + 0.10e2 .* w_1 .* ((C_2 .* t544 .* xi_1) + (B_1 .* t95) ./ 0.6e1 + xi_1 .* (t546 + t548) - (2 .* A_2 .* eta_1) + C_3)) + D_TE .* (0.5e1 .* t534 .* t554 .* xi_1 + 0.15e2 ./ 0.2e1 .* C_2 .* (t95 .* (t2 + 0.1e1 ./ 0.9e1) .* w_1 - 0.16e2 ./ 0.9e1 .* t507 + 0.2e1 ./ 0.3e1 .* w_3 + 0.2e1 ./ 0.3e1 .* t510) .* xi_1 + 0.5e1 ./ 0.2e1 .* t518 .* t263 .* E + 0.10e2 .* t95 .* (t493 + t569 - t570 + A_2 ./ 0.3e1) .* w_1 - 0.20e2 .* xi_1 .* w_1 .* (t573 - t240 ./ 0.2e1 + t575 ./ 0.2e1) + 0.10e2 .* A_2 .* t527 - 0.20e2 .* eta_1 .* C_3 .* w_1) + t10 .* t672 + 0.2e1 .* t11 .* t672 + t676 .* t474 .* t518 + 0.5e1 ./ 0.2e1 .* t263 .* t590 + t95 .* (t528 - t531) + xi_1 .* (t601 + t602 - t605) + 0.10e2 .* t527 .* C_3;
t699 = log(t383 .* (t6 .* t307 + xi_3 .* t2 + (D_TE - eta_1) .* E - xi_1 + xi_3));
t707 = -(-0.2e1 .* t307 .* w_2 .* t6 .* t295 - t385 .* t378 .* t375 .* w_2 + t6 .* (0.2e1 .* t379 .* t378 .* w_2 .* (t61 .* t147 + D_TE .* (0.2e1 .* A_1 .* E .* (xi_1 .* t137 + t392 ./ 0.3e1) + C_2 .* (xi_1 .* (0.4e1 ./ 0.3e1 .* t135 + 0.10e2 ./ 0.3e1 .* t18 + t328) + (-0.8e1 ./ 0.3e1 + 0.22e2 ./ 0.3e1 .* t2) .* eta_1) - 0.2e1 ./ 0.3e1 .* xi_1 .* B_1 .* t391 - 0.2e1 ./ 0.3e1 .* t175 + t183) + A_1 .* t2 .* t418 + 0.2e1 .* C_2 .* E .* t418 + t95 .* (0.19e2 ./ 0.6e1 .* t2 + t50 + 0.14e2 ./ 0.3e1) .* t24 + xi_1 .* (0.2e1 ./ 0.3e1 .* B_1 .* t392 + 0.8e1 ./ 0.3e1 .* E .* t42 .* t3 .* (t2 + 0.5e1 ./ 0.2e1)) + t232 ./ 0.3e1 + 0.4e1 ./ 0.3e1 .* t291) + 0.8e1 ./ 0.5e1 .* t304 .* t5 .* t687) + t378 .* t375 .* w_2 .* t699) .* rho ./ t6 ./ t5 .* (-eta_3 + eta_1) ./ 0.16e2;

u_out = t707;
end