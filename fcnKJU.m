function [u_out] = fcnKJU(xi_1, xi_3, eta_1, eta_3, E, D_TE, A_1, A_2, B_1, B_2, C_2, C_3, u, v, w, rho)
u_1 = u(:,1); u_2 = u(:,2); u_3 = u(:,3);
v_1 = v(:,1); v_2 = v(:,2); v_3 = v(:,3);
w_1 = w(:,1); w_2 = w(:,2); w_3 = w(:,3);

t1 = (E .^ 2);
t2 = t1 + 1;
t3 = t2 .^ 2;
t4 = t2 .* t3;
t5 = sqrt(t2);
t9 = (eta_1 .^ 2);
t12 = (eta_3 .^ 2);
t13 = -xi_3 + xi_1;
t14 = (t13 .^ 2);
t16 = sqrt((-2 .* eta_3 .* eta_1 + t12 + t14 + t9));
t21 = (E .* C_2);
t23 = t1 .* A_1 + B_1 + 2 .* t21;
t25 = xi_3 .^ 2;
t26 = (xi_3 .* t25);
t28 = E .* t1;
t32 = C_2 .* t1;
t34 = E .* B_1;
t39 = E .* eta_1;
t40 = t39 + xi_1;
t47 = xi_1 .* B_1;
t49 = B_1 .* t39;
t51 = E .* A_2;
t52 = t51 + B_2;
t53 = t52 .* t2;
t59 = t1 .^ 2;
t71 = D_TE .^ 2;
t73 = t1 ./ 0.2e1;
t82 = 0.2e1 ./ 0.3e1 .* t1;
t88 = E .* xi_1;
t89 = B_1 .* t88;
t97 = E .* B_2;
t105 = xi_1 .^ 2;
t107 = xi_1 .* t39;
t111 = t105 .* (-0.2e1 ./ 0.3e1 + t1) - 0.10e2 ./ 0.3e1 .* t107 + (-t82 + 0.1e1) .* t9;
t126 = t1 - 0.3e1 ./ 0.2e1;
t130 = eta_1 .* t1;
t131 = A_2 .* t130;
t132 = B_2 .* t39;
t133 = C_3 .* t1;
t144 = E .* t59;
t146 = 0.14e2 ./ 0.3e1 .* E + t144 + 0.19e2 ./ 0.6e1 .* t28;
t149 = 0.2e1 ./ 0.3e1 .* t59;
t152 = t1 - 0.13e2 ./ 0.2e1;
t153 = t152 .* E;
t156 = A_1 .* t146 + C_2 .* (-(3 .* t1) - t149 + 0.8e1 ./ 0.3e1) + B_1 .* t153 ./ 0.3e1;
t157 = D_TE .* t71;
t173 = t1 - 0.1e1 ./ 0.2e1;
t174 = t173 .* (t1 + 16);
t183 = eta_1 .* B_1;
t184 = t183 .* t153;
t185 = 0.5e1 ./ 0.2e1 .* E;
t192 = 0.8e1 ./ 0.3e1 .* (A_2 .* (t28 + t185) + (-t73 + 0.1e1) .* B_2) .* t2;
t200 = eta_1 .* xi_1;
t209 = 12 .* t1;
t223 = t1 - 0.32e2 ./ 0.13e2;
t239 = t9 .* E;
t241 = B_1 .* t152 .* t239;
t249 = E .* C_3;
t251 = 3 .* t2 .* t249;
t263 = t105 .* (t1 - 0.2e1 ./ 0.13e2) - 0.30e2 ./ 0.13e2 .* t107 + (-0.2e1 ./ 0.13e2 .* t1 + 0.1e1) .* t9;
t275 = xi_1 .* t105;
t289 = (t2 .* C_3) ./ 0.2e1;
t296 = t1 - 2;
t302 = t2 .* (A_2 .* t296 .* t39 + B_2 .* t296 .* eta_1 + t251);
t306 = (t26 .* t23 .* t4) + 0.3e1 .* t25 .* (D_TE .* (A_1 .* (t28 + 0.8e1 ./ 0.9e1 .* E) + 0.10e2 ./ 0.9e1 .* t32 + t34 ./ 0.9e1 + 0.8e1 ./ 0.9e1 .* C_2) - (A_1 .* t40 .* t1) ./ 0.9e1 - 0.2e1 ./ 0.9e1 .* C_2 .* t40 .* E - t47 ./ 0.9e1 - t49 ./ 0.9e1 + 0.8e1 ./ 0.9e1 .* t53) .* t3 + 0.3e1 .* xi_3 .* (t71 .* (A_1 .* (0.2e1 ./ 0.3e1 + t59 + 0.35e2 ./ 0.18e2 .* t1) + C_2 .* (0.2e1 ./ 0.9e1 .* t28 + 0.7e1 ./ 0.9e1 .* E) + (0.1e1 ./ 0.6e1 - t1 ./ 0.9e1) .* B_1) + D_TE .* (-0.2e1 ./ 0.9e1 .* A_1 .* (xi_1 .* (-t73 + 0.2e1) + (t1 + 0.7e1 ./ 0.2e1) .* t39) .* E + C_2 .* (xi_1 .* (-0.4e1 ./ 0.9e1 + t82) - 0.10e2 ./ 0.9e1 .* t39) + 0.5e1 ./ 0.9e1 .* t89 + B_1 .* (0.2e1 ./ 0.9e1 .* t1 - 0.1e1 ./ 0.3e1) .* eta_1 + 0.16e2 ./ 0.9e1 .* t2 .* (A_2 .* (t1 + 0.3e1 ./ 0.4e1) + t97 ./ 0.4e1)) + A_1 .* t111 .* t1 ./ 0.6e1 + C_2 .* t111 .* E ./ 0.3e1 + t105 .* (-0.1e1 ./ 0.9e1 + t1 ./ 0.6e1) .* B_1 + xi_1 .* (-0.5e1 ./ 0.9e1 .* t49 - 0.4e1 ./ 0.9e1 .* t53) - B_1 .* t9 .* t126 ./ 0.9e1 - 0.4e1 ./ 0.9e1 .* (t131 + t132 - 3 .* t133 - 3 .* C_3) .* t2) .* t2 + t157 .* t156 + t71 .* (A_1 .* (xi_1 .* (t149 - 0.2e1 + 0.37e2 ./ 0.6e1 .* t1) - eta_1 .* (t59 + t73 + 0.22e2) .* E ./ 0.3e1) + C_2 .* (xi_1 .* (-0.8e1 ./ 0.3e1 .* t28 + 0.37e2 ./ 0.3e1 .* E) + 0.2e1 ./ 0.3e1 .* eta_1 .* t174) + xi_1 .* (0.13e2 ./ 0.6e1 - 0.16e2 ./ 0.3e1 .* t1) .* B_1 - t184 + t192) + D_TE .* (A_1 .* (t105 .* (t59 + 0.40e2 ./ 0.3e1 .* t1 - 0.8e1 ./ 0.3e1) + 0.16e2 ./ 0.3e1 .* t200 .* (t1 - 0.37e2 ./ 0.8e1) .* E - 0.2e1 ./ 0.3e1 .* t9 .* t174) .* E ./ 0.2e1 + C_2 .* (t105 .* (-0.4e1 ./ 0.3e1 + t209 - 0.5e1 ./ 0.3e1 .* t59) + 0.40e2 ./ 0.3e1 .* t200 .* (t1 - 0.5e1 ./ 0.4e1) .* E + 0.2e1 ./ 0.3e1 .* t9 .* (t59 - 0.35e2 ./ 0.2e1 .* t1 + 0.4e1)) - 0.13e2 ./ 0.6e1 .* t105 .* t223 .* t34 + xi_1 .* (B_1 .* (-0.13e2 ./ 0.3e1 + 0.32e2 ./ 0.3e1 .* t1) .* eta_1 + (4 .* A_2 .* t59) + (8 .* B_2 .* t28) + (8 .* t97) - (4 .* A_2)) + t241 - 0.4e1 ./ 0.3e1 .* (A_2 .* (t1 + 7) .* t39 + B_2 .* eta_1 .* (-2 .* t1 + 4) - t251) .* t2) + 0.13e2 ./ 0.6e1 .* A_1 .* t40 .* t1 .* t263 + 0.13e2 ./ 0.3e1 .* C_2 .* t40 .* E .* t263 + t275 .* (0.13e2 ./ 0.6e1 .* t1 - 0.1e1 ./ 0.3e1) .* B_1 + t105 .* (0.13e2 ./ 0.6e1 .* t183 .* t223 .* E + 0.8e1 ./ 0.3e1 .* t173 .* t53) + xi_1 .* (-0.16e2 ./ 0.3e1 .* B_1 .* t9 .* (t1 - 0.13e2 ./ 0.32e2) - 0.8e1 .* t2 .* (t131 + t132 + t289)) - 0.4e1 ./ 0.3e1 .* (t241 ./ 0.4e1 + t302) .* eta_1;
t316 = sqrt(t9 + 0.2e1 .* eta_1 .* (-E .* xi_3 - D_TE) + t71 + 0.2e1 .* D_TE .* E .* xi_3 + t25 .* t1 + t14);
t320 = t88 + D_TE - eta_1;
t321 = t320 .^ 2;
t322 = t1 - 4;
t329 = 2 .* t28;
t331 = t329 - 8 .* E;
t338 = 8 .* t28;
t339 = 12 .* E;
t354 = 4 .* t1;
t366 = xi_1 .* t1;
t387 = (t71 .* (A_1 .* t322 - 4 .* B_1 .* t1 + B_1 + 10 .* t21) + D_TE .* (A_1 .* (xi_1 .* t331 - 10 .* t130) + C_2 .* (xi_1 .* (t209 - 8) + eta_1 .* (t338 - t339)) + 10 .* t89 + B_1 .* eta_1 .* (8 .* t1 - 2) + 8 .* (t97 - A_2) .* t2) + (A_1 .* (t105 .* (t59 - t354) - 10 .* eta_1 .* xi_1 .* t28 + t9 .* (-4 .* t59 + t1))) + (C_2 .* (t105 .* t331 - 20 .* eta_1 .* t366 + t9 .* (-t338 + 2 .* E))) + (t105 .* t322 .* B_1) + (xi_1 .* (-10 .* t49 - 8 .* t53)) + (B_1 .* t9 .* (-t354 + 1)) - (8 .* (t131 + t132 + t133 + C_3) .* t2)) .* t321;
t388 = sign(t320);
t392 = 0.1e1 ./ t5;

t394 = log(t392 .* t320 .* (t388 .* t5 + E));
t394(isinf(t394)) = -1e50;

t401 = 0.9e1 ./ 0.2e1 .* t1 + t59 - 0.4e1;
t402 = eta_1 .* t401;
t428 = t105 .* t146 + 0.2e1 ./ 0.3e1 .* xi_1 .* t402 + t152 .* t239 ./ 0.3e1;
t454 = t25 .^ 2;
t483 = t1 + 0.1e1 ./ 0.6e1;
t502 = A_2 .* t1;
t507 = 0.2e1 ./ 0.3e1 .* A_2;
t513 = t105 .* t483 .* w_1;
t515 = eta_1 .* w_1 .* t88;
t518 = t9 .* w_1;
t520 = t513 - 0.5e1 ./ 0.2e1 .* t515 + 0.5e1 ./ 0.3e1 .* w_3 + 0.5e1 ./ 0.3e1 .* t518;
t526 = B_1 .* w_1;
t535 = t518 + w_3;
t536 = 0.5e1 ./ 0.3e1 .* B_1 .* t535;
t539 = 0.20e2 ./ 0.3e1 .* (t131 + t132 - t289) .* w_1;
t552 = t88 - eta_1;
t554 = 0.3e1 ./ 0.2e1 .* t51;
t556 = B_2 ./ 0.2e1;
t563 = E .* (t513 - 0.2e1 .* t515 + t518 + w_3);
t571 = 0.5e1 .* t518;
t572 = 0.5e1 .* w_3;
t575 = t105 .* E;
t578 = 0.2e1 ./ 0.3e1 .* t97;
t579 = t183 ./ 0.3e1;
t582 = A_2 .* t39;
t584 = eta_1 .* B_2;
t590 = A_1 .* t520;
t592 = C_2 .* t520;
t600 = (-t49 + (0.1e1 ./ 0.3e1 + t1) .* t52) .* w_1;
t611 = 0.5e1 .* A_2 .* t535 .* E;
t612 = 0.5e1 .* B_2 .* t535;
t615 = 0.10e2 .* C_3 .* w_1 .* t39;
t616 = 0.10e2 .* t157 .* w_1 .* ((E .* A_1) + C_2 ./ 0.2e1) + 0.10e2 .* t71 .* (A_1 .* (t366 - 0.3e1 ./ 0.2e1 .* t39 - xi_1 ./ 0.3e1) + (C_2 .* t552) + t554 + t47 ./ 0.6e1 + t556) .* w_1 + D_TE .* (0.5e1 .* A_1 .* t563 + C_2 .* (t105 .* (0.15e2 ./ 0.2e1 .* t1 + 0.5e1 ./ 0.6e1) .* w_1 - 0.40e2 ./ 0.3e1 .* t515 + t571 + t572) + 0.10e2 .* ((B_1 .* t575) ./ 0.4e1 + xi_1 .* (t502 + t578 - t579 - t507) - (2 .* t582) + t249 - t584) .* w_1) + t590 .* t366 + 0.2e1 .* t592 .* t88 + t275 .* t483 .* t526 + 0.5e1 ./ 0.2e1 .* t105 .* t600 + xi_1 .* (t536 - 0.20e2 ./ 0.3e1 .* w_1 .* (t131 - t133 ./ 0.2e1 + t132 + C_3)) + t611 + t612 - t615;
t618 = t71 .^ 2;
t686 = t105 .^ 2;
t697 = t454 .* t23 .* t2 .* w_1 + t26 .* (D_TE .* (A_1 .* ((5 .* t28) + t185) + 0.5e1 ./ 0.2e1 .* C_2 + 0.15e2 ./ 0.2e1 .* t32 + 0.5e1 ./ 0.2e1 .* t34) + A_1 .* (xi_1 .* t126 - 0.5e1 ./ 0.2e1 .* t39) .* t1 + (C_2 .* (xi_1 .* (t329 - 3 .* E) - 5 .* t130)) + xi_1 .* t126 .* B_1 - 0.5e1 ./ 0.2e1 .* t49 + 0.5e1 ./ 0.2e1 .* t53) .* w_1 + t25 .* (0.10e2 .* t71 .* (A_1 .* t483 + t21 + B_1 ./ 0.6e1) .* w_1 + 0.5e1 .* D_TE .* (A_1 .* (xi_1 .* (t1 - 0.5e1 ./ 0.6e1) - (2 .* t39)) .* E + C_2 .* (xi_1 .* (0.3e1 ./ 0.2e1 .* t1 - 0.5e1 ./ 0.6e1) - 0.8e1 ./ 0.3e1 .* t39) + (2 .* t502) + t89 ./ 0.2e1 + 0.4e1 ./ 0.3e1 .* t97 - 0.2e1 ./ 0.3e1 .* t183 + t507) .* w_1 + A_1 .* t520 .* t1 + 0.2e1 .* C_2 .* t520 .* E + t105 .* t483 .* t526 + 0.5e1 ./ 0.2e1 .* xi_1 .* w_1 .* (-t49 + (t1 - 0.5e1 ./ 0.3e1) .* t52) + t536 - t539) + xi_3 .* t616 + 0.5e1 .* w_1 .* A_1 .* t618 + 0.10e2 .* t157 .* ((A_1 .* t552) + (xi_1 .* C_2) ./ 0.2e1 + A_2) .* w_1 + t71 .* (A_1 .* (t105 .* (0.5e1 ./ 0.3e1 + (10 .* t1)) .* w_1 - 0.15e2 .* t515 + t571 + t572) + 0.10e2 .* ((C_2 .* t552 .* xi_1) + (B_1 .* t105) ./ 0.6e1 + xi_1 .* (t554 + t556) - (2 .* A_2 .* eta_1) + C_3) .* w_1) + D_TE .* (0.5e1 .* xi_1 .* A_1 .* t563 + 0.15e2 ./ 0.2e1 .* C_2 .* (t105 .* (t1 + 0.1e1 ./ 0.9e1) .* w_1 - 0.16e2 ./ 0.9e1 .* t515 + 0.2e1 ./ 0.3e1 .* w_3 + 0.2e1 ./ 0.3e1 .* t518) .* xi_1 + 0.5e1 ./ 0.2e1 .* t526 .* t275 .* E + 0.10e2 .* t105 .* (t502 + t578 - t579 + A_2 ./ 0.3e1) .* w_1 - 0.20e2 .* xi_1 .* (t582 - t249 ./ 0.2e1 + t584 ./ 0.2e1) .* w_1 + 0.10e2 .* A_2 .* t535 - 0.20e2 .* eta_1 .* C_3 .* w_1) + t590 .* t105 .* t1 + 0.2e1 .* t592 .* t575 + t686 .* t483 .* t526 + 0.5e1 ./ 0.2e1 .* t275 .* t600 + t105 .* (t536 - t539) + xi_1 .* (t611 + t612 - t615) + 0.10e2 .* t535 .* C_3;
t709 = log((t5 .* t316 + xi_3 .* t1 + (D_TE - eta_1) .* E - xi_1 + xi_3) .* t392);
t716 = -(-0.2e1 .* t316 .* w_2 .* t306 .* t5 - t394 .* w_2 .* t387 + t5 .* (0.2e1 .* t388 .* (t71 .* t156 + D_TE .* (0.2e1 .* A_1 .* (xi_1 .* t146 + t402 ./ 0.3e1) .* E + C_2 .* (xi_1 .* (0.4e1 ./ 0.3e1 .* t144 + 0.10e2 ./ 0.3e1 .* t28 + t339) + (-0.8e1 ./ 0.3e1 + 0.22e2 ./ 0.3e1 .* t1) .* eta_1) - 0.2e1 ./ 0.3e1 .* xi_1 .* t401 .* B_1 - 0.2e1 ./ 0.3e1 .* t184 + t192) + A_1 .* t428 .* t1 + 0.2e1 .* C_2 .* t428 .* E + t105 .* (0.14e2 ./ 0.3e1 + t59 + 0.19e2 ./ 0.6e1 .* t1) .* t34 + xi_1 .* (0.2e1 ./ 0.3e1 .* B_1 .* t402 + 0.8e1 ./ 0.3e1 .* (t1 + 0.5e1 ./ 0.2e1) .* t2 .* E .* t52) + t241 ./ 0.3e1 + 0.4e1 ./ 0.3e1 .* t302) .* w_2 .* t321 + 0.8e1 ./ 0.5e1 .* t13 .* t697 .* t4) + t709 .* w_2 .* t387) .* (-eta_3 + eta_1) ./ t16 .* rho ./ t5 ./ t4 ./ 0.16e2;


u_out = t716;
end